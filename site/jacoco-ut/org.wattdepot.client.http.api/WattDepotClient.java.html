<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>WattDepotClient.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">WattDepot</a> &gt; <a href="index.source.html" class="el_package">org.wattdepot.client.http.api</a> &gt; <span class="el_source">WattDepotClient.java</span></div><h1>WattDepotClient.java</h1><pre class="source lang-java linenums">/**
 * WattDepotClient.java This file is part of WattDepot.
 *
 * Copyright (C) 2013  Cam Moore
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.
 */
package org.wattdepot.client.http.api;

import java.util.Date;
import java.util.List;
import java.util.logging.Logger;

import javax.xml.datatype.DatatypeConfigurationException;

import org.restlet.data.ChallengeResponse;
import org.restlet.data.ChallengeScheme;
import org.restlet.data.Reference;
import org.restlet.resource.ClientResource;
import org.restlet.resource.ResourceException;
import org.wattdepot.client.ClientProperties;
import org.wattdepot.client.WattDepotInterface;
import org.wattdepot.common.domainmodel.CollectorProcessDefinition;
import org.wattdepot.common.domainmodel.CollectorProcessDefinitionList;
import org.wattdepot.common.domainmodel.Depository;
import org.wattdepot.common.domainmodel.DepositoryList;
import org.wattdepot.common.domainmodel.DescriptiveStats;
import org.wattdepot.common.domainmodel.InterpolatedValue;
import org.wattdepot.common.domainmodel.InterpolatedValueList;
import org.wattdepot.common.domainmodel.Labels;
import org.wattdepot.common.domainmodel.Measurement;
import org.wattdepot.common.domainmodel.MeasurementList;
import org.wattdepot.common.domainmodel.MeasurementPruningDefinition;
import org.wattdepot.common.domainmodel.MeasurementPruningDefinitionList;
import org.wattdepot.common.domainmodel.MeasurementType;
import org.wattdepot.common.domainmodel.MeasurementTypeList;
import org.wattdepot.common.domainmodel.Sensor;
import org.wattdepot.common.domainmodel.SensorGroup;
import org.wattdepot.common.domainmodel.SensorGroupList;
import org.wattdepot.common.domainmodel.SensorList;
import org.wattdepot.common.domainmodel.SensorModel;
import org.wattdepot.common.domainmodel.SensorModelList;
import org.wattdepot.common.domainmodel.SensorStatus;
import org.wattdepot.common.domainmodel.SensorStatusList;
import org.wattdepot.common.exception.BadCredentialException;
import org.wattdepot.common.exception.IdNotFoundException;
import org.wattdepot.common.exception.MeasurementGapException;
import org.wattdepot.common.exception.MeasurementListSizeExceededException;
import org.wattdepot.common.exception.MeasurementTypeException;
import org.wattdepot.common.exception.NoMeasurementException;
import org.wattdepot.common.http.api.CollectorProcessDefinitionPutResource;
import org.wattdepot.common.http.api.CollectorProcessDefinitionResource;
import org.wattdepot.common.http.api.CollectorProcessDefinitionsResource;
import org.wattdepot.common.http.api.DepositoriesResource;
import org.wattdepot.common.http.api.DepositoryDescriptiveStatsResource;
import org.wattdepot.common.http.api.DepositoryHistoricalValuesResource;
import org.wattdepot.common.http.api.DepositoryMeasurementPutResource;
import org.wattdepot.common.http.api.DepositoryMeasurementResource;
import org.wattdepot.common.http.api.DepositoryMeasurementsPutResource;
import org.wattdepot.common.http.api.DepositoryMeasurementsResource;
import org.wattdepot.common.http.api.DepositoryMinimumValuesResource;
import org.wattdepot.common.http.api.DepositoryPutResource;
import org.wattdepot.common.http.api.DepositoryResource;
import org.wattdepot.common.http.api.DepositorySensorStatusResource;
import org.wattdepot.common.http.api.DepositorySensorsResource;
import org.wattdepot.common.http.api.DepositoryValueResource;
import org.wattdepot.common.http.api.DepositoryValuesResource;
import org.wattdepot.common.http.api.MeasurementPruningDefinitionPutResource;
import org.wattdepot.common.http.api.MeasurementPruningDefinitionResource;
import org.wattdepot.common.http.api.MeasurementPruningDefinitionsResource;
import org.wattdepot.common.http.api.MeasurementTypePutResource;
import org.wattdepot.common.http.api.MeasurementTypeResource;
import org.wattdepot.common.http.api.MeasurementTypesResource;
import org.wattdepot.common.http.api.SensorGroupPutResource;
import org.wattdepot.common.http.api.SensorGroupResource;
import org.wattdepot.common.http.api.SensorGroupsResource;
import org.wattdepot.common.http.api.SensorModelPutResource;
import org.wattdepot.common.http.api.SensorModelResource;
import org.wattdepot.common.http.api.SensorModelsResource;
import org.wattdepot.common.http.api.SensorPutResource;
import org.wattdepot.common.http.api.SensorResource;
import org.wattdepot.common.http.api.SensorsResource;
import org.wattdepot.common.util.DateConvert;
import org.wattdepot.common.util.UnitsHelper;
import org.wattdepot.common.util.logger.LoggerUtil;

/**
 * WattDepotClient - high-level Java implementation that communicates with a
 * WattDepot server. It implements the WattDepotInterface that hides the HTTP
 * Labels.
 * 
 * 
 * @author Cam Moore
 * 
 */
public class WattDepotClient implements WattDepotInterface {

  /** The URI for the WattDepot server. */
  private String wattDepotUri;
  /** The HTTP authentication approach. */
<span class="fc" id="L112">  private ChallengeScheme scheme = ChallengeScheme.HTTP_BASIC;</span>
  /** The credentials for this client. */
  private ChallengeResponse authentication;
  /** The Group this client belongs to. */
  private String organizationId;
  /** The logger for this client. */
  private Logger logger;
  /** The client properties. */
  private ClientProperties properties;

  /**
   * Creates a new WattDepotClient.
   * 
   * @param serverUri The URI of the WattDepot server (e.g.
   *        &quot;http://server.wattdepot.org/&quot;)
   * @param username The name of the user. The user must be defined in the
   *        WattDepot server.
   * @param orgId the organization the user is in.
   * @param password The password for the user.
   * @throws BadCredentialException If the user or password don't match the
   *         credentials on the WattDepot server.
   */
  public WattDepotClient(String serverUri, String username, String orgId, String password)
<span class="fc" id="L135">      throws BadCredentialException {</span>
    // ensure that the UnitsHelper class is loaded.
<span class="fc" id="L137">    new UnitsHelper();</span>
<span class="fc" id="L138">    this.properties = new ClientProperties();</span>
<span class="fc" id="L139">    this.logger = Logger.getLogger(&quot;org.wattdepot.client&quot;);</span>
<span class="fc" id="L140">    LoggerUtil.setLoggingLevel(this.logger, properties.get(ClientProperties.LOGGING_LEVEL_KEY));</span>
<span class="fc" id="L141">    LoggerUtil.useConsoleHandler();</span>
<span class="fc" id="L142">    logger.finest(&quot;Client &quot; + serverUri + &quot;, &quot; + username + &quot;, &quot; + password);</span>
<span class="fc" id="L143">    this.authentication = new ChallengeResponse(this.scheme, username, password);</span>
<span class="fc bfc" id="L144" title="All 2 branches covered.">    if (serverUri == null) {</span>
<span class="fc" id="L145">      throw new IllegalArgumentException(&quot;serverUri cannot be null&quot;);</span>
    }
<span class="fc bfc" id="L147" title="All 2 branches covered.">    if (!serverUri.endsWith(&quot;/&quot;)) {</span>
<span class="fc" id="L148">      throw new IllegalArgumentException(&quot;serverUri must end with '/'&quot;);</span>
    }
<span class="fc" id="L150">    this.wattDepotUri = serverUri + Labels.WATTDEPOT + &quot;/&quot;;</span>

<span class="fc" id="L152">    ClientResource client = null;</span>
<span class="fc" id="L153">    client = makeClient(orgId + &quot;/&quot;);</span>
    try {
<span class="fc" id="L155">      client.head();</span>
<span class="pc bpc" id="L156" title="1 of 2 branches missed.">      if (client.getLocationRef() != null) {</span>
<span class="nc" id="L157">        String path = client.getLocationRef().getPath();</span>
<span class="nc" id="L158">        path = path.substring(0, path.length() - 1);</span>
<span class="nc" id="L159">        int lastSlash = path.lastIndexOf('/') + 1;</span>
<span class="nc" id="L160">        organizationId = path.substring(lastSlash);</span>
<span class="nc" id="L161">      }</span>
      else {
<span class="fc" id="L163">        organizationId = orgId;</span>
      }
<span class="fc" id="L165">      client.release();</span>
    }
<span class="fc" id="L167">    catch (ResourceException e) {</span>
<span class="fc" id="L168">      throw new BadCredentialException(e.getMessage() + &quot; username and or password are not corect.&quot;);</span>
<span class="fc" id="L169">    }</span>
<span class="fc" id="L170">  }</span>

  /*
   * (non-Javadoc)
   * 
   * @see
   * org.wattdepot.client.WattDepotInterface#deleteCollectorProcessDefinition
   * (org.wattdepot .datamodel.CollectorProcessDefinition)
   */
  @Override
  public void deleteCollectorProcessDefinition(CollectorProcessDefinition process)
      throws IdNotFoundException {
<span class="fc" id="L182">    ClientResource client = makeClient(this.organizationId + &quot;/&quot;</span>
        + Labels.COLLECTOR_PROCESS_DEFINITION + &quot;/&quot; + process.getId());
<span class="fc" id="L184">    CollectorProcessDefinitionResource resource = client</span>
        .wrap(CollectorProcessDefinitionResource.class);
    try {
<span class="fc" id="L187">      resource.remove();</span>
    }
<span class="fc" id="L189">    catch (ResourceException e) {</span>
<span class="fc" id="L190">      throw new IdNotFoundException(process + &quot; is not stored in WattDepot.&quot;);</span>
    }
    finally {
<span class="fc" id="L193">      client.release();</span>
<span class="fc" id="L194">    }</span>
<span class="fc" id="L195">  }</span>

  /*
   * (non-Javadoc)
   * 
   * @see org.wattdepot.client.WattDepotInterface#deleteDepository(org.wattdepot
   * .datamodel.Depository)
   */
  @Override
  public void deleteDepository(Depository depository) throws IdNotFoundException {
<span class="fc" id="L205">    ClientResource client = makeClient(this.organizationId + &quot;/&quot; + Labels.DEPOSITORY + &quot;/&quot;</span>
        + depository.getId());
<span class="fc" id="L207">    DepositoryResource resource = client.wrap(DepositoryResource.class);</span>
    try {
<span class="fc" id="L209">      resource.remove();</span>
    }
<span class="fc" id="L211">    catch (ResourceException e) {</span>
<span class="fc" id="L212">      throw new IdNotFoundException(depository + &quot; is not stored in WattDepot.&quot;);</span>
    }
    finally {
<span class="fc" id="L215">      client.release();</span>
<span class="fc" id="L216">    }</span>
<span class="fc" id="L217">  }</span>

  /*
   * (non-Javadoc)
   *
   * @see
   * org.wattdepot.client.WattDepotInterface#deleteMeasurement(org.wattdepot
   * .datamodel.Depository, org.wattdepot.datamodel.Measurement)
   */
  @Override
  public void deleteMeasurement(Depository depository, Measurement measurement)
      throws IdNotFoundException {
<span class="fc" id="L229">    ClientResource client = makeClient(this.organizationId + &quot;/&quot; + Labels.DEPOSITORY + &quot;/&quot;</span>
        + depository.getId() + &quot;/&quot; + Labels.MEASUREMENT + &quot;/&quot; + measurement.getId());
<span class="fc" id="L231">    DepositoryMeasurementResource resource = client.wrap(DepositoryMeasurementResource.class);</span>
    try {
<span class="fc" id="L233">      resource.remove();</span>
    }
<span class="fc" id="L235">    catch (ResourceException e) {</span>
<span class="fc" id="L236">      throw new IdNotFoundException(measurement + &quot; is not stored in WattDepot.&quot;);</span>
<span class="fc" id="L237">    }</span>
<span class="fc" id="L238">    client.release();</span>
<span class="fc" id="L239">  }</span>

  @Override
  public void deleteMeasurementPruningDefinition(MeasurementPruningDefinition gcd) throws IdNotFoundException {
<span class="fc" id="L243">    ClientResource client = makeClient(this.organizationId + &quot;/&quot; + Labels.MEASUREMENT_PRUNING_DEFINITION + &quot;/&quot;</span>
        + gcd.getId());
<span class="fc" id="L245">    MeasurementPruningDefinitionResource resource = client.wrap(MeasurementPruningDefinitionResource.class);</span>
    try {
<span class="fc" id="L247">      resource.remove();</span>
    }
<span class="fc" id="L249">    catch (ResourceException e) {</span>
<span class="fc" id="L250">      throw new IdNotFoundException(gcd + &quot;is not stored in WattDepot&quot;);</span>
    }
    finally {
<span class="fc" id="L253">      client.release();</span>
<span class="fc" id="L254">    }</span>
<span class="fc" id="L255">  }</span>

  /*
   * (non-Javadoc)
   * 
   * @see
   * org.wattdepot.client.WattDepotInterface#deleteMeasurementType(org.wattdepot
   * .datamodel.MeasurementType)
   */
  @Override
  public void deleteMeasurementType(MeasurementType type) throws IdNotFoundException {
<span class="fc" id="L266">    ClientResource client = makeClient(Labels.PUBLIC + &quot;/&quot; + Labels.MEASUREMENT_TYPE + &quot;/&quot;</span>
        + type.getId());
<span class="fc" id="L268">    MeasurementTypeResource resource = client.wrap(MeasurementTypeResource.class);</span>
    try {
<span class="fc" id="L270">      resource.remove();</span>
    }
<span class="fc" id="L272">    catch (ResourceException e) {</span>
<span class="fc" id="L273">      throw new IdNotFoundException(type + &quot; is not stored in WattDepot.&quot;);</span>
<span class="fc" id="L274">    }</span>
<span class="fc" id="L275">    client.release();</span>
<span class="fc" id="L276">  }</span>

  /*
   * (non-Javadoc)
   * 
   * @see
   * org.wattdepot.client.WattDepotInterface#deleteSensor(org.wattdepot.datamodel
   * .Sensor)
   */
  @Override
  public void deleteSensor(Sensor sensor) throws IdNotFoundException {
<span class="fc" id="L287">    ClientResource client = makeClient(this.organizationId + &quot;/&quot; + Labels.SENSOR + &quot;/&quot;</span>
        + sensor.getId());
<span class="fc" id="L289">    SensorResource resource = client.wrap(SensorResource.class);</span>
    try {
<span class="fc" id="L291">      resource.remove();</span>
    }
<span class="fc" id="L293">    catch (ResourceException e) {</span>
<span class="fc" id="L294">      throw new IdNotFoundException(sensor + &quot; is not stored in WattDepot.&quot;);</span>
<span class="fc" id="L295">    }</span>
<span class="fc" id="L296">    client.release();</span>
<span class="fc" id="L297">  }</span>

  /*
   * (non-Javadoc)
   * 
   * @see
   * org.wattdepot.client.WattDepotInterface#deleteSensorGroup(org.wattdepot
   * .datamodel.SensorGroup)
   */
  @Override
  public void deleteSensorGroup(SensorGroup group) throws IdNotFoundException {
<span class="fc" id="L308">    ClientResource client = makeClient(this.organizationId + &quot;/&quot; + Labels.SENSOR_GROUP + &quot;/&quot;</span>
        + group.getId());
<span class="fc" id="L310">    SensorGroupResource resource = client.wrap(SensorGroupResource.class);</span>
    try {
<span class="fc" id="L312">      resource.remove();</span>
    }
<span class="fc" id="L314">    catch (ResourceException e) {</span>
<span class="fc" id="L315">      throw new IdNotFoundException(group + &quot; is not stored in WattDepot.&quot;);</span>
    }
    finally {
<span class="fc" id="L318">      client.release();</span>
<span class="fc" id="L319">    }</span>
<span class="fc" id="L320">  }</span>

  /*
   * (non-Javadoc)
   * 
   * @see
   * org.wattdepot.client.WattDepotInterface#deleteSensorModel(org.wattdepot
   * .datamodel.SensorModel)
   */
  @Override
  public void deleteSensorModel(SensorModel model) throws IdNotFoundException {
<span class="fc" id="L331">    ClientResource client = makeClient(Labels.PUBLIC + &quot;/&quot; + Labels.SENSOR_MODEL + &quot;/&quot;</span>
        + model.getId());
<span class="fc" id="L333">    SensorModelResource resource = client.wrap(SensorModelResource.class);</span>
    try {
<span class="fc" id="L335">      resource.remove();</span>
    }
<span class="fc" id="L337">    catch (ResourceException e) {</span>
<span class="fc" id="L338">      throw new IdNotFoundException(model + &quot; is not stored in WattDepot.&quot;);</span>
    }
    finally {
<span class="fc" id="L341">      client.release();</span>
<span class="fc" id="L342">    }</span>
<span class="fc" id="L343">  }</span>

  @Override
  public InterpolatedValueList getAverageValues(Depository depository, Sensor sensor, Date start, Date end, Integer interval, Boolean usePointValues) throws NoMeasurementException {
<span class="nc" id="L347">    ClientResource client = null;</span>
    try {
<span class="nc" id="L349">      String valueType = Labels.DIFFERENCE;</span>
<span class="nc bnc" id="L350" title="All 2 branches missed.">      if (usePointValues) {</span>
<span class="nc" id="L351">        valueType = Labels.POINT;</span>
      }
<span class="nc" id="L353">      client = makeClient(this.organizationId + &quot;/&quot; + Labels.DEPOSITORY + &quot;/&quot; + depository.getId()</span>
          + &quot;/&quot; + Labels.VALUES + &quot;/&quot; + Labels.AVERAGE + &quot;/&quot; + &quot;?sensor=&quot; + sensor.getId() + &quot;&amp;start=&quot;
          + DateConvert.convertDate(start) + &quot;&amp;end=&quot; + DateConvert.convertDate(end) + &quot;&amp;interval=&quot; + interval + &quot;&amp;value-type=&quot; + valueType);
<span class="nc" id="L356">      DepositoryMinimumValuesResource resource = client.wrap(DepositoryMinimumValuesResource.class);</span>
<span class="nc" id="L357">      InterpolatedValueList ret = resource.retrieve();</span>
<span class="nc" id="L358">      client.release();</span>
<span class="nc" id="L359">      return ret;</span>
    }
<span class="nc" id="L361">    catch (ResourceException e1) {</span>
<span class="nc" id="L362">      throw new NoMeasurementException(e1.getCause());</span>
    }
<span class="nc" id="L364">    catch (DatatypeConfigurationException e) {</span>
<span class="nc" id="L365">      e.printStackTrace();</span>
    }
    finally {
<span class="nc bnc" id="L368" title="All 6 branches missed.">      if (client != null) {</span>
<span class="nc" id="L369">        client.release();</span>
      }
    }
<span class="nc" id="L372">    return null;</span>
  }

  @Override
  public InterpolatedValueList getAverageValues(Depository depository, SensorGroup group, Date start, Date end, Integer interval, Boolean usePointValues) throws NoMeasurementException {
<span class="nc" id="L377">    ClientResource client = null;</span>
    try {
<span class="nc" id="L379">      String valueType = Labels.DIFFERENCE;</span>
<span class="nc bnc" id="L380" title="All 2 branches missed.">      if (usePointValues) {</span>
<span class="nc" id="L381">        valueType = Labels.POINT;</span>
      }
<span class="nc" id="L383">      client = makeClient(this.organizationId + &quot;/&quot; + Labels.DEPOSITORY + &quot;/&quot; + depository.getId()</span>
          + &quot;/&quot; + Labels.VALUES + &quot;/&quot; + Labels.AVERAGE + &quot;/&quot; + &quot;?sensor=&quot; + group.getId() + &quot;&amp;start=&quot;
          + DateConvert.convertDate(start) + &quot;&amp;end=&quot; + DateConvert.convertDate(end) + &quot;&amp;interval=&quot; + interval + &quot;&amp;value-type=&quot; + valueType);
<span class="nc" id="L386">      DepositoryMinimumValuesResource resource = client.wrap(DepositoryMinimumValuesResource.class);</span>
<span class="nc" id="L387">      InterpolatedValueList ret = resource.retrieve();</span>
<span class="nc" id="L388">      client.release();</span>
<span class="nc" id="L389">      return ret;</span>
    }
<span class="nc" id="L391">    catch (ResourceException e1) {</span>
<span class="nc" id="L392">      throw new NoMeasurementException(e1.getCause());</span>
    }
<span class="nc" id="L394">    catch (DatatypeConfigurationException e) {</span>
<span class="nc" id="L395">      e.printStackTrace();</span>
    }
    finally {
<span class="nc bnc" id="L398" title="All 6 branches missed.">      if (client != null) {</span>
<span class="nc" id="L399">        client.release();</span>
      }
    }
<span class="nc" id="L402">    return null;</span>
  }

  /*
   * (non-Javadoc)
   *
   * @see
   * org.wattdepot.client.WattDepotInterface#getCollectorProcessDefinition(java
   * .lang .String)
   */
  @Override
  public CollectorProcessDefinition getCollectorProcessDefinition(String id)
      throws IdNotFoundException {
<span class="fc" id="L415">    ClientResource client = makeClient(this.organizationId + &quot;/&quot;</span>
        + Labels.COLLECTOR_PROCESS_DEFINITION + &quot;/&quot; + id);
<span class="fc" id="L417">    CollectorProcessDefinitionResource resource = client</span>
        .wrap(CollectorProcessDefinitionResource.class);
    try {
<span class="fc" id="L420">      CollectorProcessDefinition ret = resource.retrieve();</span>
<span class="fc" id="L421">      client.release();</span>
<span class="fc" id="L422">      return ret;</span>
    }
<span class="fc" id="L424">    catch (ResourceException e) {</span>
<span class="fc" id="L425">      throw new IdNotFoundException(id + &quot; is not a known CollectorProcessDefinition. &quot;);</span>
    }
    finally {
<span class="pc bpc" id="L428" title="2 of 4 branches missed.">      if (client != null) {</span>
<span class="fc" id="L429">        client.release();</span>
      }
    }
  }

  /*
   * (non-Javadoc)
   *
   * @see
   * org.wattdepot.client.WattDepotInterface#getCollectorProcessDefinitions()
   */
  @Override
  public CollectorProcessDefinitionList getCollectorProcessDefinitions() {
<span class="fc" id="L442">    ClientResource client = makeClient(this.organizationId + &quot;/&quot;</span>
        + Labels.COLLECTOR_PROCESS_DEFINITIONS + &quot;/&quot;);
<span class="fc" id="L444">    CollectorProcessDefinitionsResource resource = client</span>
        .wrap(CollectorProcessDefinitionsResource.class);
<span class="fc" id="L446">    CollectorProcessDefinitionList ret = resource.retrieve();</span>
<span class="fc" id="L447">    client.release();</span>
<span class="fc" id="L448">    return ret;</span>
  }

  @Override
  public InterpolatedValueList getDailyValues(Depository depository, Sensor sensor, Date start, Date end, Boolean usePointValues) {
<span class="nc" id="L453">    ClientResource client = null;</span>
    try {
<span class="nc" id="L455">      StringBuilder sb = new StringBuilder();</span>
<span class="nc" id="L456">      sb.append(this.organizationId);</span>
<span class="nc" id="L457">      sb.append(&quot;/&quot;);</span>
<span class="nc" id="L458">      sb.append(Labels.DEPOSITORY);</span>
<span class="nc" id="L459">      sb.append(&quot;/&quot;);</span>
<span class="nc" id="L460">      sb.append(depository.getId());</span>
<span class="nc" id="L461">      sb.append(&quot;/&quot;);</span>
<span class="nc" id="L462">      sb.append(Labels.DAILY);</span>
<span class="nc" id="L463">      sb.append(&quot;/&quot;);</span>
<span class="nc" id="L464">      sb.append(Labels.VALUES);</span>
<span class="nc" id="L465">      sb.append(&quot;/?&quot;);</span>
<span class="nc" id="L466">      sb.append(Labels.SENSOR);</span>
<span class="nc" id="L467">      sb.append(&quot;=&quot;);</span>
<span class="nc" id="L468">      sb.append(sensor.getId());</span>
<span class="nc" id="L469">      sb.append(&quot;&amp;&quot;);</span>
<span class="nc" id="L470">      sb.append(Labels.START);</span>
<span class="nc" id="L471">      sb.append(&quot;=&quot;);</span>
<span class="nc" id="L472">      sb.append(DateConvert.convertDate(start));</span>
<span class="nc" id="L473">      sb.append(&quot;&amp;&quot;);</span>
<span class="nc" id="L474">      sb.append(Labels.END);</span>
<span class="nc" id="L475">      sb.append(&quot;=&quot;);</span>
<span class="nc" id="L476">      sb.append(DateConvert.convertDate(end));</span>
<span class="nc" id="L477">      sb.append(&quot;&amp;&quot;);</span>
<span class="nc" id="L478">      sb.append(Labels.VALUE_TYPE);</span>
<span class="nc" id="L479">      sb.append(&quot;=&quot;);</span>
<span class="nc bnc" id="L480" title="All 2 branches missed.">      if (usePointValues) {</span>
<span class="nc" id="L481">        sb.append(Labels.POINT);</span>
      }
      else {
<span class="nc" id="L484">        sb.append(Labels.DIFFERENCE);</span>
      }
<span class="nc" id="L486">      client = makeClient(sb.toString());</span>
<span class="nc" id="L487">      DepositoryValuesResource resource = client.wrap(DepositoryValuesResource.class);</span>
<span class="nc" id="L488">      InterpolatedValueList ret = resource.retrieve();</span>
<span class="nc" id="L489">      client.release();</span>
<span class="nc" id="L490">      return ret;</span>
    }
<span class="nc" id="L492">    catch (DatatypeConfigurationException e) {</span>
<span class="nc" id="L493">      e.printStackTrace();</span>
    }
    finally {
<span class="nc bnc" id="L496" title="All 6 branches missed.">      if (client != null) {</span>
<span class="nc" id="L497">        client.release();</span>
      }
    }
<span class="nc" id="L500">    return null;</span>
  }

  @Override
  public InterpolatedValueList getDailyValues(Depository depository, SensorGroup group, Date start, Date end, Boolean usePointValues) {
<span class="nc" id="L505">    ClientResource client = null;</span>
    try {
<span class="nc" id="L507">      StringBuilder sb = new StringBuilder();</span>
<span class="nc" id="L508">      sb.append(this.organizationId);</span>
<span class="nc" id="L509">      sb.append(&quot;/&quot;);</span>
<span class="nc" id="L510">      sb.append(Labels.DEPOSITORY);</span>
<span class="nc" id="L511">      sb.append(&quot;/&quot;);</span>
<span class="nc" id="L512">      sb.append(depository.getId());</span>
<span class="nc" id="L513">      sb.append(&quot;/&quot;);</span>
<span class="nc" id="L514">      sb.append(Labels.DAILY);</span>
<span class="nc" id="L515">      sb.append(&quot;/&quot;);</span>
<span class="nc" id="L516">      sb.append(Labels.VALUES);</span>
<span class="nc" id="L517">      sb.append(&quot;/?&quot;);</span>
<span class="nc" id="L518">      sb.append(Labels.SENSOR);</span>
<span class="nc" id="L519">      sb.append(&quot;=&quot;);</span>
<span class="nc" id="L520">      sb.append(group.getId());</span>
<span class="nc" id="L521">      sb.append(&quot;&amp;&quot;);</span>
<span class="nc" id="L522">      sb.append(Labels.START);</span>
<span class="nc" id="L523">      sb.append(&quot;=&quot;);</span>
<span class="nc" id="L524">      sb.append(DateConvert.convertDate(start));</span>
<span class="nc" id="L525">      sb.append(&quot;&amp;&quot;);</span>
<span class="nc" id="L526">      sb.append(Labels.END);</span>
<span class="nc" id="L527">      sb.append(&quot;=&quot;);</span>
<span class="nc" id="L528">      sb.append(DateConvert.convertDate(end));</span>
<span class="nc" id="L529">      sb.append(&quot;&amp;&quot;);</span>
<span class="nc" id="L530">      sb.append(Labels.VALUE_TYPE);</span>
<span class="nc" id="L531">      sb.append(&quot;=&quot;);</span>
<span class="nc bnc" id="L532" title="All 2 branches missed.">      if (usePointValues) {</span>
<span class="nc" id="L533">        sb.append(Labels.POINT);</span>
      }
      else {
<span class="nc" id="L536">        sb.append(Labels.DIFFERENCE);</span>
      }
<span class="nc" id="L538">      client = makeClient(sb.toString());</span>
<span class="nc" id="L539">      DepositoryValuesResource resource = client.wrap(DepositoryValuesResource.class);</span>
<span class="nc" id="L540">      InterpolatedValueList ret = resource.retrieve();</span>
<span class="nc" id="L541">      client.release();</span>
<span class="nc" id="L542">      return ret;</span>
    }
<span class="nc" id="L544">    catch (DatatypeConfigurationException e) {</span>
<span class="nc" id="L545">      e.printStackTrace();</span>
    }
    finally {
<span class="nc bnc" id="L548" title="All 6 branches missed.">      if (client != null) {</span>
<span class="nc" id="L549">        client.release();</span>
      }
    }
<span class="nc" id="L552">    return null;</span>
  }

  /*
   * (non-Javadoc)
   *
   * @see org.wattdepot.client.WattDepotInterface#getDepositories()
   */
  @Override
  public DepositoryList getDepositories() {
<span class="fc" id="L562">    ClientResource client = makeClient(this.organizationId + &quot;/&quot; + Labels.DEPOSITORIES + &quot;/&quot;);</span>
<span class="fc" id="L563">    DepositoriesResource resource = client.wrap(DepositoriesResource.class);</span>
<span class="fc" id="L564">    DepositoryList ret = null;</span>
    try {
<span class="fc" id="L566">      ret = resource.retrieve();</span>
    }
    finally {
<span class="pc" id="L569">      client.release();</span>
<span class="fc" id="L570">    }</span>
<span class="fc" id="L571">    return ret;</span>
  }

  /*
   * (non-Javadoc)
   *
   * @see
   * org.wattdepot.client.WattDepotInterface#getDepository(java.lang.String)
   */
  @Override
  public Depository getDepository(String id) throws IdNotFoundException {
<span class="fc" id="L582">    ClientResource client = makeClient(this.organizationId + &quot;/&quot; + Labels.DEPOSITORY + &quot;/&quot; + id);</span>
<span class="fc" id="L583">    DepositoryResource resource = client.wrap(DepositoryResource.class);</span>
<span class="fc" id="L584">    Depository ret = null;</span>
    try {
<span class="fc" id="L586">      ret = resource.retrieve();</span>
    }
<span class="fc" id="L588">    catch (ResourceException e) {</span>
<span class="fc" id="L589">      throw new IdNotFoundException(id + &quot; is not a known Depository id.&quot;);</span>
    }
    finally {
<span class="fc" id="L592">      client.release();</span>
<span class="fc" id="L593">    }</span>
<span class="fc" id="L594">    return ret;</span>
  }

  /*
   * (non-Javadoc)
   *
   * @see
   * org.wattdepot.client.WattDepotInterface#getDepositorySensors(java.lang.
   * String)
   */
  @Override
  public SensorList getDepositorySensors(String id) throws IdNotFoundException {
<span class="fc" id="L606">    ClientResource client = makeClient(this.organizationId + &quot;/&quot; + Labels.DEPOSITORY + &quot;/&quot; + id</span>
        + &quot;/&quot; + Labels.SENSORS + &quot;/&quot;);
<span class="fc" id="L608">    DepositorySensorsResource resource = client.wrap(DepositorySensorsResource.class);</span>
<span class="fc" id="L609">    SensorList ret = null;</span>
    try {
<span class="fc" id="L611">      ret = resource.retrieve();</span>
    }
<span class="nc" id="L613">    catch (ResourceException e) {</span>
<span class="nc" id="L614">      throw new IdNotFoundException(id + &quot; is not a known Depository id.&quot;);</span>
    }
    finally {
<span class="pc" id="L617">      client.release();</span>
<span class="fc" id="L618">    }</span>
<span class="fc" id="L619">    return ret;</span>
  }

  @Override
  public DescriptiveStats getDescriptiveStats(Depository depository, Sensor sensor, Date timestamp, Boolean daily, Integer samples, Boolean pointValues) {
<span class="nc" id="L624">    StringBuilder stringBuilder = new StringBuilder();</span>
<span class="nc" id="L625">    stringBuilder.append(this.organizationId);</span>
<span class="nc" id="L626">    stringBuilder.append(&quot;/&quot;);</span>
<span class="nc" id="L627">    stringBuilder.append(Labels.DEPOSITORY);</span>
<span class="nc" id="L628">    stringBuilder.append(&quot;/&quot;);</span>
<span class="nc" id="L629">    stringBuilder.append(depository.getId());</span>
<span class="nc" id="L630">    stringBuilder.append(&quot;/&quot;);</span>
<span class="nc" id="L631">    stringBuilder.append(Labels.DESCRIPTIVE_STATS);</span>
<span class="nc" id="L632">    stringBuilder.append(&quot;/&quot;);</span>
<span class="nc bnc" id="L633" title="All 2 branches missed.">    if (daily) {</span>
<span class="nc" id="L634">      stringBuilder.append(Labels.DAILY);</span>
    }
    else {
<span class="nc" id="L637">      stringBuilder.append(Labels.HOURLY);</span>
    }
<span class="nc" id="L639">    stringBuilder.append(&quot;/?&quot;);</span>
<span class="nc" id="L640">    stringBuilder.append(Labels.SENSOR);</span>
<span class="nc" id="L641">    stringBuilder.append(&quot;=&quot;);</span>
<span class="nc" id="L642">    stringBuilder.append(sensor.getId());</span>
<span class="nc" id="L643">    stringBuilder.append(&quot;&amp;&quot;);</span>
<span class="nc" id="L644">    stringBuilder.append(Labels.TIMESTAMP);</span>
<span class="nc" id="L645">    stringBuilder.append(&quot;=&quot;);</span>
    try {
<span class="nc" id="L647">      stringBuilder.append(DateConvert.convertDate(timestamp).toXMLFormat());</span>
    }
<span class="nc" id="L649">    catch (DatatypeConfigurationException e) {</span>
<span class="nc" id="L650">      e.printStackTrace();</span>
<span class="nc" id="L651">    }</span>
<span class="nc" id="L652">    stringBuilder.append(&quot;&amp;&quot;);</span>
<span class="nc" id="L653">    stringBuilder.append(Labels.VALUE_TYPE);</span>
<span class="nc" id="L654">    stringBuilder.append(&quot;=&quot;);</span>
<span class="nc bnc" id="L655" title="All 2 branches missed.">    if (pointValues) {</span>
<span class="nc" id="L656">      stringBuilder.append(Labels.POINT);</span>
    }
    else {
<span class="nc" id="L659">      stringBuilder.append(Labels.DIFFERENCE);</span>
    }
<span class="nc" id="L661">    stringBuilder.append(&quot;&amp;&quot;);</span>
<span class="nc" id="L662">    stringBuilder.append(Labels.SAMPLES);</span>
<span class="nc" id="L663">    stringBuilder.append(&quot;=&quot;);</span>
<span class="nc" id="L664">    stringBuilder.append(samples);</span>
<span class="nc" id="L665">    ClientResource client = makeClient(stringBuilder.toString());</span>
<span class="nc" id="L666">    DepositoryDescriptiveStatsResource resource = client.wrap(DepositoryDescriptiveStatsResource.class);</span>
<span class="nc" id="L667">    DescriptiveStats values = null;</span>
    try {
<span class="nc" id="L669">      values = resource.retrieve();</span>
    }
<span class="nc" id="L671">    catch (ResourceException re) {</span>
<span class="nc" id="L672">      throw re;</span>
    }
    finally {
<span class="nc" id="L675">      client.release();</span>
<span class="nc" id="L676">    }</span>
<span class="nc" id="L677">    return values;</span>
  }

//http://mopsa.ics.hawaii.edu:8192/wattdepot/uh/depository/energy/historical-values/daily/?sensor=lehua-total&amp;timestamp=2015-08-15T12:00:00.000-10:00&amp;value-type=difference&amp;samples=5
  @Override
  public DescriptiveStats getDescriptiveStats(Depository depository, SensorGroup group, Date timestamp, Boolean daily, Integer samples, Boolean pointValues) {
<span class="nc" id="L683">    StringBuilder stringBuilder = new StringBuilder();</span>
<span class="nc" id="L684">    stringBuilder.append(this.organizationId);</span>
<span class="nc" id="L685">    stringBuilder.append(&quot;/&quot;);</span>
<span class="nc" id="L686">    stringBuilder.append(Labels.DEPOSITORY);</span>
<span class="nc" id="L687">    stringBuilder.append(&quot;/&quot;);</span>
<span class="nc" id="L688">    stringBuilder.append(depository.getId());</span>
<span class="nc" id="L689">    stringBuilder.append(&quot;/&quot;);</span>
<span class="nc" id="L690">    stringBuilder.append(Labels.DESCRIPTIVE_STATS);</span>
<span class="nc" id="L691">    stringBuilder.append(&quot;/&quot;);</span>
<span class="nc bnc" id="L692" title="All 2 branches missed.">    if (daily) {</span>
<span class="nc" id="L693">      stringBuilder.append(Labels.DAILY);</span>
    }
    else {
<span class="nc" id="L696">      stringBuilder.append(Labels.HOURLY);</span>
    }
<span class="nc" id="L698">    stringBuilder.append(&quot;/?&quot;);</span>
<span class="nc" id="L699">    stringBuilder.append(Labels.SENSOR);</span>
<span class="nc" id="L700">    stringBuilder.append(&quot;=&quot;);</span>
<span class="nc" id="L701">    stringBuilder.append(group.getId());</span>
<span class="nc" id="L702">    stringBuilder.append(&quot;&amp;&quot;);</span>
<span class="nc" id="L703">    stringBuilder.append(Labels.TIMESTAMP);</span>
<span class="nc" id="L704">    stringBuilder.append(&quot;=&quot;);</span>
    try {
<span class="nc" id="L706">      stringBuilder.append(DateConvert.convertDate(timestamp).toXMLFormat());</span>
    }
<span class="nc" id="L708">    catch (DatatypeConfigurationException e) {</span>
<span class="nc" id="L709">      e.printStackTrace();</span>
<span class="nc" id="L710">    }</span>
<span class="nc" id="L711">    stringBuilder.append(&quot;&amp;&quot;);</span>
<span class="nc" id="L712">    stringBuilder.append(Labels.VALUE_TYPE);</span>
<span class="nc" id="L713">    stringBuilder.append(&quot;=&quot;);</span>
<span class="nc bnc" id="L714" title="All 2 branches missed.">    if (pointValues) {</span>
<span class="nc" id="L715">      stringBuilder.append(Labels.POINT);</span>
    }
    else {
<span class="nc" id="L718">      stringBuilder.append(Labels.DIFFERENCE);</span>
    }
<span class="nc" id="L720">    stringBuilder.append(&quot;&amp;&quot;);</span>
<span class="nc" id="L721">    stringBuilder.append(Labels.SAMPLES);</span>
<span class="nc" id="L722">    stringBuilder.append(&quot;=&quot;);</span>
<span class="nc" id="L723">    stringBuilder.append(samples);</span>
<span class="nc" id="L724">    ClientResource client = makeClient(stringBuilder.toString());</span>
<span class="nc" id="L725">    DepositoryDescriptiveStatsResource resource = client.wrap(DepositoryDescriptiveStatsResource.class);</span>
<span class="nc" id="L726">    DescriptiveStats values = null;</span>
    try {
<span class="nc" id="L728">      values = resource.retrieve();</span>
    }
<span class="nc" id="L730">    catch (ResourceException re) {</span>
<span class="nc" id="L731">      throw re;</span>
    }
    finally {
<span class="nc" id="L734">      client.release();</span>
<span class="nc" id="L735">    }</span>
<span class="nc" id="L736">    return values;  }</span>

  /*
   * (non-Javadoc)
   *
   * @see
   * org.wattdepot.client.WattDepotInterface#getEarliestMeasurement(org.wattdepot
   * .common.domainmodel.Depository, org.wattdepot.common.domainmodel.Sensor)
   */
  @Override
  public InterpolatedValue getEarliestValue(Depository depository, Sensor sensor) {
<span class="fc" id="L747">    ClientResource client = makeClient(this.organizationId + &quot;/&quot; + Labels.DEPOSITORY + &quot;/&quot;</span>
        + depository.getId() + &quot;/&quot; + Labels.VALUE + &quot;/&quot; + &quot;?sensor=&quot; + sensor.getId()
        + &quot;&amp;earliest=true&quot;);
<span class="fc" id="L750">    DepositoryValueResource resource = client.wrap(DepositoryValueResource.class);</span>
<span class="fc" id="L751">    InterpolatedValue ret = resource.retrieve();</span>
<span class="fc" id="L752">    client.release();</span>
<span class="fc" id="L753">    return ret;</span>
  }

  /*
   * (non-Javadoc)
   *
   * @see
   * org.wattdepot.client.WattDepotInterface#getEarliestValue(org.wattdepot.
   * common.domainmodel.Depository,
   * org.wattdepot.common.domainmodel.SensorGroup)
   */
  @Override
  public InterpolatedValue getEarliestValue(Depository depository, SensorGroup group) {
<span class="fc" id="L766">    ClientResource client = makeClient(this.organizationId + &quot;/&quot; + Labels.DEPOSITORY + &quot;/&quot;</span>
        + depository.getId() + &quot;/&quot; + Labels.VALUE + &quot;/&quot; + &quot;?sensor=&quot; + group.getId()
        + &quot;&amp;earliest=true&quot;);
<span class="fc" id="L769">    DepositoryValueResource resource = client.wrap(DepositoryValueResource.class);</span>
<span class="fc" id="L770">    InterpolatedValue ret = resource.retrieve();</span>
<span class="fc" id="L771">    client.release();</span>
<span class="fc" id="L772">    return ret;</span>
  }

  @Override
  public InterpolatedValueList getHistoricalValues(Depository depository, Sensor sensor, Date timestamp, Boolean daily, Integer samples, Boolean pointValues) {
<span class="nc" id="L777">    ClientResource client = null;</span>
<span class="nc" id="L778">    StringBuilder stringBuilder = new StringBuilder();</span>
<span class="nc" id="L779">    stringBuilder.append(this.organizationId);</span>
<span class="nc" id="L780">    stringBuilder.append(&quot;/&quot;);</span>
<span class="nc" id="L781">    stringBuilder.append(Labels.DEPOSITORY);</span>
<span class="nc" id="L782">    stringBuilder.append(&quot;/&quot;);</span>
<span class="nc" id="L783">    stringBuilder.append(depository.getId());</span>
<span class="nc" id="L784">    stringBuilder.append(&quot;/&quot;);</span>
<span class="nc" id="L785">    stringBuilder.append(Labels.HISTORICAL_VALUES);</span>
<span class="nc" id="L786">    stringBuilder.append(&quot;/&quot;);</span>
<span class="nc bnc" id="L787" title="All 2 branches missed.">    if (daily) {</span>
<span class="nc" id="L788">      stringBuilder.append(Labels.DAILY);</span>
    }
    else {
<span class="nc" id="L791">      stringBuilder.append(Labels.HOURLY);</span>
    }
<span class="nc" id="L793">    stringBuilder.append(&quot;/?&quot;);</span>
<span class="nc" id="L794">    stringBuilder.append(Labels.SENSOR);</span>
<span class="nc" id="L795">    stringBuilder.append(&quot;=&quot;);</span>
<span class="nc" id="L796">    stringBuilder.append(sensor.getId());</span>
<span class="nc" id="L797">    stringBuilder.append(&quot;&amp;&quot;);</span>
<span class="nc" id="L798">    stringBuilder.append(Labels.TIMESTAMP);</span>
<span class="nc" id="L799">    stringBuilder.append(&quot;=&quot;);</span>
    try {
<span class="nc" id="L801">      stringBuilder.append(DateConvert.convertDate(timestamp).toXMLFormat());</span>
    }
<span class="nc" id="L803">    catch (DatatypeConfigurationException e) {</span>
<span class="nc" id="L804">      e.printStackTrace();</span>
<span class="nc" id="L805">    }</span>
<span class="nc" id="L806">    stringBuilder.append(&quot;&amp;&quot;);</span>
<span class="nc" id="L807">    stringBuilder.append(Labels.VALUE_TYPE);</span>
<span class="nc" id="L808">    stringBuilder.append(&quot;=&quot;);</span>
<span class="nc bnc" id="L809" title="All 2 branches missed.">    if (pointValues) {</span>
<span class="nc" id="L810">      stringBuilder.append(Labels.POINT);</span>
    }
    else {
<span class="nc" id="L813">      stringBuilder.append(Labels.DIFFERENCE);</span>
    }
<span class="nc" id="L815">    stringBuilder.append(&quot;&amp;&quot;);</span>
<span class="nc" id="L816">    stringBuilder.append(Labels.SAMPLES);</span>
<span class="nc" id="L817">    stringBuilder.append(&quot;=&quot;);</span>
<span class="nc" id="L818">    stringBuilder.append(samples);</span>
    try {
<span class="nc" id="L820">      client = makeClient(stringBuilder.toString());</span>
<span class="nc" id="L821">      DepositoryHistoricalValuesResource resource = client.wrap(DepositoryHistoricalValuesResource.class);</span>
<span class="nc" id="L822">      InterpolatedValueList ret = resource.retrieve();</span>
<span class="nc" id="L823">      return ret;</span>
    }
<span class="nc" id="L825">    catch (ResourceException re) {</span>
<span class="nc" id="L826">      throw re;</span>
    }
    finally {
<span class="nc" id="L829">      client.release();</span>
    }
  }

  @Override
  public InterpolatedValueList getHistoricalValues(Depository depository, SensorGroup group, Date timestamp, Boolean daily, Integer samples, Boolean pointValues) {
<span class="nc" id="L835">    ClientResource client = null;</span>
<span class="nc" id="L836">    StringBuilder stringBuilder = new StringBuilder();</span>
<span class="nc" id="L837">    stringBuilder.append(this.organizationId);</span>
<span class="nc" id="L838">    stringBuilder.append(&quot;/&quot;);</span>
<span class="nc" id="L839">    stringBuilder.append(Labels.DEPOSITORY);</span>
<span class="nc" id="L840">    stringBuilder.append(&quot;/&quot;);</span>
<span class="nc" id="L841">    stringBuilder.append(depository.getId());</span>
<span class="nc" id="L842">    stringBuilder.append(&quot;/&quot;);</span>
<span class="nc" id="L843">    stringBuilder.append(Labels.HISTORICAL_VALUES);</span>
<span class="nc" id="L844">    stringBuilder.append(&quot;/&quot;);</span>
<span class="nc bnc" id="L845" title="All 2 branches missed.">    if (daily) {</span>
<span class="nc" id="L846">      stringBuilder.append(Labels.DAILY);</span>
    }
    else {
<span class="nc" id="L849">      stringBuilder.append(Labels.HOURLY);</span>
    }
<span class="nc" id="L851">    stringBuilder.append(&quot;/?&quot;);</span>
<span class="nc" id="L852">    stringBuilder.append(Labels.SENSOR);</span>
<span class="nc" id="L853">    stringBuilder.append(&quot;=&quot;);</span>
<span class="nc" id="L854">    stringBuilder.append(group.getId());</span>
<span class="nc" id="L855">    stringBuilder.append(&quot;&amp;&quot;);</span>
<span class="nc" id="L856">    stringBuilder.append(Labels.TIMESTAMP);</span>
<span class="nc" id="L857">    stringBuilder.append(&quot;=&quot;);</span>
    try {
<span class="nc" id="L859">      stringBuilder.append(DateConvert.convertDate(timestamp).toXMLFormat());</span>
    }
<span class="nc" id="L861">    catch (DatatypeConfigurationException e) {</span>
<span class="nc" id="L862">      e.printStackTrace();</span>
<span class="nc" id="L863">    }</span>
<span class="nc" id="L864">    stringBuilder.append(&quot;&amp;&quot;);</span>
<span class="nc" id="L865">    stringBuilder.append(Labels.VALUE_TYPE);</span>
<span class="nc" id="L866">    stringBuilder.append(&quot;=&quot;);</span>
<span class="nc bnc" id="L867" title="All 2 branches missed.">    if (pointValues) {</span>
<span class="nc" id="L868">      stringBuilder.append(Labels.POINT);</span>
    }
    else {
<span class="nc" id="L871">      stringBuilder.append(Labels.DIFFERENCE);</span>
    }
<span class="nc" id="L873">    stringBuilder.append(&quot;&amp;&quot;);</span>
<span class="nc" id="L874">    stringBuilder.append(Labels.SAMPLES);</span>
<span class="nc" id="L875">    stringBuilder.append(&quot;=&quot;);</span>
<span class="nc" id="L876">    stringBuilder.append(samples);</span>
    try {
<span class="nc" id="L878">      client = makeClient(stringBuilder.toString());</span>
<span class="nc" id="L879">      DepositoryHistoricalValuesResource resource = client.wrap(DepositoryHistoricalValuesResource.class);</span>
<span class="nc" id="L880">      InterpolatedValueList ret = resource.retrieve();</span>
<span class="nc" id="L881">      return ret;</span>
    }
<span class="nc" id="L883">    catch (ResourceException re) {</span>
<span class="nc" id="L884">      throw re;</span>
    }
    finally {
<span class="nc" id="L887">      client.release();</span>
    }
  }

  @Override
  public InterpolatedValueList getHourlyValues(Depository depository, Sensor sensor, Date start, Date end, Boolean usePointValues) {
<span class="nc" id="L893">    ClientResource client = null;</span>
    try {
<span class="nc" id="L895">      StringBuilder sb = new StringBuilder();</span>
<span class="nc" id="L896">      sb.append(this.organizationId);</span>
<span class="nc" id="L897">      sb.append(&quot;/&quot;);</span>
<span class="nc" id="L898">      sb.append(Labels.DEPOSITORY);</span>
<span class="nc" id="L899">      sb.append(&quot;/&quot;);</span>
<span class="nc" id="L900">      sb.append(depository.getId());</span>
<span class="nc" id="L901">      sb.append(&quot;/&quot;);</span>
<span class="nc" id="L902">      sb.append(Labels.HOURLY);</span>
<span class="nc" id="L903">      sb.append(&quot;/&quot;);</span>
<span class="nc" id="L904">      sb.append(Labels.VALUES);</span>
<span class="nc" id="L905">      sb.append(&quot;/?&quot;);</span>
<span class="nc" id="L906">      sb.append(Labels.SENSOR);</span>
<span class="nc" id="L907">      sb.append(&quot;=&quot;);</span>
<span class="nc" id="L908">      sb.append(sensor.getId());</span>
<span class="nc" id="L909">      sb.append(&quot;&amp;&quot;);</span>
<span class="nc" id="L910">      sb.append(Labels.START);</span>
<span class="nc" id="L911">      sb.append(&quot;=&quot;);</span>
<span class="nc" id="L912">      sb.append(DateConvert.convertDate(start));</span>
<span class="nc" id="L913">      sb.append(&quot;&amp;&quot;);</span>
<span class="nc" id="L914">      sb.append(Labels.END);</span>
<span class="nc" id="L915">      sb.append(&quot;=&quot;);</span>
<span class="nc" id="L916">      sb.append(DateConvert.convertDate(end));</span>
<span class="nc" id="L917">      sb.append(&quot;&amp;&quot;);</span>
<span class="nc" id="L918">      sb.append(Labels.VALUE_TYPE);</span>
<span class="nc" id="L919">      sb.append(&quot;=&quot;);</span>
<span class="nc bnc" id="L920" title="All 2 branches missed.">      if (usePointValues) {</span>
<span class="nc" id="L921">        sb.append(Labels.POINT);</span>
      }
      else {
<span class="nc" id="L924">        sb.append(Labels.DIFFERENCE);</span>
      }
<span class="nc" id="L926">      client = makeClient(sb.toString());</span>
<span class="nc" id="L927">      DepositoryValuesResource resource = client.wrap(DepositoryValuesResource.class);</span>
<span class="nc" id="L928">      InterpolatedValueList ret = resource.retrieve();</span>
<span class="nc" id="L929">      client.release();</span>
<span class="nc" id="L930">      return ret;</span>
    }
<span class="nc" id="L932">    catch (DatatypeConfigurationException e) {</span>
<span class="nc" id="L933">      e.printStackTrace();</span>
    }
    finally {
<span class="nc bnc" id="L936" title="All 6 branches missed.">      if (client != null) {</span>
<span class="nc" id="L937">        client.release();</span>
      }
    }
<span class="nc" id="L940">    return null;</span>
  }

  @Override
  public InterpolatedValueList getHourlyValues(Depository depository, SensorGroup group, Date start, Date end, Boolean usePointValues) {
<span class="nc" id="L945">    ClientResource client = null;</span>
    try {
<span class="nc" id="L947">      StringBuilder sb = new StringBuilder();</span>
<span class="nc" id="L948">      sb.append(this.organizationId);</span>
<span class="nc" id="L949">      sb.append(&quot;/&quot;);</span>
<span class="nc" id="L950">      sb.append(Labels.DEPOSITORY);</span>
<span class="nc" id="L951">      sb.append(&quot;/&quot;);</span>
<span class="nc" id="L952">      sb.append(depository.getId());</span>
<span class="nc" id="L953">      sb.append(&quot;/&quot;);</span>
<span class="nc" id="L954">      sb.append(Labels.HOURLY);</span>
<span class="nc" id="L955">      sb.append(&quot;/&quot;);</span>
<span class="nc" id="L956">      sb.append(Labels.VALUES);</span>
<span class="nc" id="L957">      sb.append(&quot;/?&quot;);</span>
<span class="nc" id="L958">      sb.append(Labels.SENSOR);</span>
<span class="nc" id="L959">      sb.append(&quot;=&quot;);</span>
<span class="nc" id="L960">      sb.append(group.getId());</span>
<span class="nc" id="L961">      sb.append(&quot;&amp;&quot;);</span>
<span class="nc" id="L962">      sb.append(Labels.START);</span>
<span class="nc" id="L963">      sb.append(&quot;=&quot;);</span>
<span class="nc" id="L964">      sb.append(DateConvert.convertDate(start));</span>
<span class="nc" id="L965">      sb.append(&quot;&amp;&quot;);</span>
<span class="nc" id="L966">      sb.append(Labels.END);</span>
<span class="nc" id="L967">      sb.append(&quot;=&quot;);</span>
<span class="nc" id="L968">      sb.append(DateConvert.convertDate(end));</span>
<span class="nc" id="L969">      sb.append(&quot;&amp;&quot;);</span>
<span class="nc" id="L970">      sb.append(Labels.VALUE_TYPE);</span>
<span class="nc" id="L971">      sb.append(&quot;=&quot;);</span>
<span class="nc bnc" id="L972" title="All 2 branches missed.">      if (usePointValues) {</span>
<span class="nc" id="L973">        sb.append(Labels.POINT);</span>
      }
      else {
<span class="nc" id="L976">        sb.append(Labels.DIFFERENCE);</span>
      }
<span class="nc" id="L978">      client = makeClient(sb.toString());</span>
<span class="nc" id="L979">      DepositoryValuesResource resource = client.wrap(DepositoryValuesResource.class);</span>
<span class="nc" id="L980">      InterpolatedValueList ret = resource.retrieve();</span>
<span class="nc" id="L981">      client.release();</span>
<span class="nc" id="L982">      return ret;</span>
    }
<span class="nc" id="L984">    catch (DatatypeConfigurationException e) {</span>
<span class="nc" id="L985">      e.printStackTrace();</span>
    }
    finally {
<span class="nc bnc" id="L988" title="All 6 branches missed.">      if (client != null) {</span>
<span class="nc" id="L989">        client.release();</span>
      }
    }
<span class="nc" id="L992">    return null;</span>
  }

  /*
   * (non-Javadoc)
   *
   * @see
   * org.wattdepot.client.WattDepotInterface#getLatestMeasurement(org.wattdepot
   * .common.domainmodel.Depository, org.wattdepot.common.domainmodel.Sensor)
   */
  @Override
  public InterpolatedValue getLatestValue(Depository depository, Sensor sensor) {
<span class="fc" id="L1004">    ClientResource client = makeClient(this.organizationId + &quot;/&quot; + Labels.DEPOSITORY + &quot;/&quot;</span>
        + depository.getId() + &quot;/&quot; + Labels.VALUE + &quot;/&quot; + &quot;?sensor=&quot; + sensor.getId()
        + &quot;&amp;latest=true&quot;);
<span class="fc" id="L1007">    DepositoryValueResource resource = client.wrap(DepositoryValueResource.class);</span>
<span class="fc" id="L1008">    InterpolatedValue ret = resource.retrieve();</span>
<span class="fc" id="L1009">    client.release();</span>
<span class="fc" id="L1010">    return ret;</span>
  }

  /*
   * (non-Javadoc)
   *
   * @see
   * org.wattdepot.client.WattDepotInterface#getLatestValue(org.wattdepot.common
   * .domainmodel.Depository, org.wattdepot.common.domainmodel.SensorGroup)
   */
  @Override
  public InterpolatedValue getLatestValue(Depository depository, SensorGroup group) {
<span class="fc" id="L1022">    ClientResource client = makeClient(this.organizationId + &quot;/&quot; + Labels.DEPOSITORY + &quot;/&quot;</span>
        + depository.getId() + &quot;/&quot; + Labels.LATEST + &quot;/&quot; + Labels.VALUE + &quot;/&quot; + &quot;?sensor=&quot; + group.getId());
<span class="fc" id="L1024">    DepositoryValueResource resource = client.wrap(DepositoryValueResource.class);</span>
<span class="fc" id="L1025">    InterpolatedValue ret = resource.retrieve();</span>
<span class="fc" id="L1026">    client.release();</span>
<span class="fc" id="L1027">    return ret;</span>
  }

  @Override
  public InterpolatedValueList getMaximumValues(Depository depository, SensorGroup group, Date start, Date end, Integer interval, Boolean usePointValues) throws NoMeasurementException {
<span class="nc" id="L1032">    ClientResource client = null;</span>
    try {
<span class="nc" id="L1034">      String valueType = Labels.DIFFERENCE;</span>
<span class="nc bnc" id="L1035" title="All 2 branches missed.">      if (usePointValues) {</span>
<span class="nc" id="L1036">        valueType = Labels.POINT;</span>
      }
<span class="nc" id="L1038">      client = makeClient(this.organizationId + &quot;/&quot; + Labels.DEPOSITORY + &quot;/&quot; + depository.getId()</span>
          + &quot;/&quot; + Labels.VALUES + &quot;/&quot; + Labels.MAXIMUM + &quot;/&quot; + &quot;?sensor=&quot; + group.getId() + &quot;&amp;start=&quot;
          + DateConvert.convertDate(start) + &quot;&amp;end=&quot; + DateConvert.convertDate(end) + &quot;&amp;interval=&quot; + interval + &quot;&amp;value-type=&quot; + valueType);
<span class="nc" id="L1041">      DepositoryMinimumValuesResource resource = client.wrap(DepositoryMinimumValuesResource.class);</span>
<span class="nc" id="L1042">      InterpolatedValueList ret = resource.retrieve();</span>
<span class="nc" id="L1043">      client.release();</span>
<span class="nc" id="L1044">      return ret;</span>
    }
<span class="nc" id="L1046">    catch (ResourceException e1) {</span>
<span class="nc" id="L1047">      throw new NoMeasurementException(e1.getCause());</span>
    }
<span class="nc" id="L1049">    catch (DatatypeConfigurationException e) {</span>
<span class="nc" id="L1050">      e.printStackTrace();</span>
    }
    finally {
<span class="nc bnc" id="L1053" title="All 6 branches missed.">      if (client != null) {</span>
<span class="nc" id="L1054">        client.release();</span>
      }
    }
<span class="nc" id="L1057">    return null;</span>
  }

  @Override
  public InterpolatedValueList getMaximumValues(Depository depository, Sensor sensor, Date start, Date end, Integer interval, Boolean usePointValues) throws NoMeasurementException {
<span class="nc" id="L1062">    ClientResource client = null;</span>
    try {
<span class="nc" id="L1064">      String valueType = Labels.DIFFERENCE;</span>
<span class="nc bnc" id="L1065" title="All 2 branches missed.">      if (usePointValues) {</span>
<span class="nc" id="L1066">        valueType = Labels.POINT;</span>
      }
<span class="nc" id="L1068">      client = makeClient(this.organizationId + &quot;/&quot; + Labels.DEPOSITORY + &quot;/&quot; + depository.getId()</span>
          + &quot;/&quot; + Labels.VALUES + &quot;/&quot; + Labels.MAXIMUM + &quot;/&quot; + &quot;?sensor=&quot; + sensor.getId() + &quot;&amp;start=&quot;
          + DateConvert.convertDate(start) + &quot;&amp;end=&quot; + DateConvert.convertDate(end) + &quot;&amp;interval=&quot; + interval + &quot;&amp;value-type=&quot; + valueType);
<span class="nc" id="L1071">      DepositoryMinimumValuesResource resource = client.wrap(DepositoryMinimumValuesResource.class);</span>
<span class="nc" id="L1072">      InterpolatedValueList ret = resource.retrieve();</span>
<span class="nc" id="L1073">      client.release();</span>
<span class="nc" id="L1074">      return ret;</span>
    }
<span class="nc" id="L1076">    catch (ResourceException e1) {</span>
<span class="nc" id="L1077">      throw new NoMeasurementException(e1.getCause());</span>
    }
<span class="nc" id="L1079">    catch (DatatypeConfigurationException e) {</span>
<span class="nc" id="L1080">      e.printStackTrace();</span>
    }
    finally {
<span class="nc bnc" id="L1083" title="All 6 branches missed.">      if (client != null) {</span>
<span class="nc" id="L1084">        client.release();</span>
      }
    }
<span class="nc" id="L1087">    return null;</span>
  }

  /*
   * (non-Javadoc)
   *
   * @see
   * org.wattdepot.client.WattDepotInterface#getMeasurementPruningDefinition(
   * java.lang.String)
   */
  @Override
  public MeasurementPruningDefinition getMeasurementPruningDefinition(String id)
      throws IdNotFoundException {
<span class="fc" id="L1100">    ClientResource client = makeClient(this.organizationId + &quot;/&quot;</span>
        + Labels.MEASUREMENT_PRUNING_DEFINITION + &quot;/&quot; + id);
<span class="fc" id="L1102">    MeasurementPruningDefinitionResource resource = client</span>
        .wrap(MeasurementPruningDefinitionResource.class);
    MeasurementPruningDefinition ret;
    try {
<span class="fc" id="L1106">      ret = resource.retrieve();</span>
    }
<span class="fc" id="L1108">    catch (ResourceException e) {</span>
<span class="fc" id="L1109">      throw new IdNotFoundException(id + &quot; is not a known MeasurementPruningDefinition id.&quot;);</span>
    }
    finally {
<span class="fc" id="L1112">      client.release();</span>
<span class="fc" id="L1113">    }</span>
<span class="fc" id="L1114">    return ret;</span>
  }

  /*
   * (non-Javadoc)
   *
   * @see
   * org.wattdepot.client.WattDepotInterface#getMeasurementPruningDefinitions()
   */
  @Override
  public MeasurementPruningDefinitionList getMeasurementPruningDefinitions() {
<span class="fc" id="L1125">    ClientResource client = makeClient(this.organizationId + &quot;/&quot;</span>
        + Labels.MEASUREMENT_PRUNING_DEFINITIONS + &quot;/&quot;);
<span class="fc" id="L1127">    MeasurementPruningDefinitionsResource resource = client</span>
        .wrap(MeasurementPruningDefinitionsResource.class);
<span class="fc" id="L1129">    MeasurementPruningDefinitionList ret = resource.retrieve();</span>
<span class="fc" id="L1130">    client.release();</span>
<span class="fc" id="L1131">    return ret;</span>
  }

  /*
   * (non-Javadoc)
   *
   * @see
   * org.wattdepot.client.WattDepotInterface#getMeasurementType(java.lang.String
   * )
   */
  @Override
  public MeasurementType getMeasurementType(String id) throws IdNotFoundException {
<span class="fc" id="L1143">    ClientResource client = makeClient(Labels.PUBLIC + &quot;/&quot; + Labels.MEASUREMENT_TYPE + &quot;/&quot; + id);</span>
<span class="fc" id="L1144">    MeasurementTypeResource resource = client.wrap(MeasurementTypeResource.class);</span>
    try {
<span class="fc" id="L1146">      MeasurementType ret = resource.retrieve();</span>
<span class="fc" id="L1147">      client.release();</span>
<span class="fc" id="L1148">      return ret;</span>
    }
<span class="fc" id="L1150">    catch (ResourceException e) {</span>
<span class="fc" id="L1151">      throw new IdNotFoundException(id + &quot; is not a known MeasurementType. &quot;);</span>
    }
    finally {
<span class="pc bpc" id="L1154" title="2 of 4 branches missed.">      if (client != null) {</span>
<span class="fc" id="L1155">        client.release();</span>
      }
    }
  }

  /*
   * (non-Javadoc)
   *
   * @see org.wattdepot.client.WattDepotInterface#getMeasurementTypes()
   */
  @Override
  public MeasurementTypeList getMeasurementTypes() {
<span class="fc" id="L1167">    ClientResource client = makeClient(Labels.PUBLIC + &quot;/&quot; + Labels.MEASUREMENT_TYPES + &quot;/&quot;);</span>
<span class="fc" id="L1168">    MeasurementTypesResource resource = client.wrap(MeasurementTypesResource.class);</span>
<span class="fc" id="L1169">    MeasurementTypeList ret = resource.retrieve();</span>
<span class="fc" id="L1170">    client.release();</span>
<span class="fc" id="L1171">    return ret;</span>
  }

  /*
   * (non-Javadoc)
   *
   * @see org.wattdepot.client.WattDepotInterface#getMeasurements(org.wattdepot
   * .datamodel.Depository, org.wattdepot.datamodel.Sensor, java.util.Date,
   * java.util.Date)
   */
  @Override
  public MeasurementList getMeasurements(Depository depository, Sensor sensor, Date start, Date end) {
    try {
<span class="fc" id="L1184">      ClientResource client = makeClient(this.organizationId + &quot;/&quot; + Labels.DEPOSITORY + &quot;/&quot;</span>
          + depository.getId() + &quot;/&quot; + Labels.MEASUREMENTS + &quot;/&quot; + &quot;?sensor=&quot; + sensor.getId()
          + &quot;&amp;start=&quot; + DateConvert.convertDate(start) + &quot;&amp;end=&quot; + DateConvert.convertDate(end));
<span class="fc" id="L1187">      DepositoryMeasurementsResource resource = client.wrap(DepositoryMeasurementsResource.class);</span>
<span class="fc" id="L1188">      MeasurementList ret = resource.retrieve();</span>
<span class="fc" id="L1189">      client.release();</span>
<span class="fc" id="L1190">      return ret;</span>
    }
<span class="nc" id="L1192">    catch (DatatypeConfigurationException e) {</span>
<span class="nc" id="L1193">      e.printStackTrace();</span>
    }
<span class="nc" id="L1195">    return null;</span>
  }

  /*
   * (non-Javadoc)
   *
   * @see org.wattdepot.client.WattDepotInterface#getMeasurements(org.wattdepot
   * .datamodel.Depository, org.wattdepot.datamodel.SensorGroup, java.util.Date,
   * java.util.Date)
   */
  @Override
  public MeasurementList getMeasurements(Depository depository, SensorGroup group, Date start,
      Date end) {
    try {
<span class="fc" id="L1209">      ClientResource client = makeClient(this.organizationId + &quot;/&quot; + Labels.DEPOSITORY + &quot;/&quot;</span>
          + depository.getId() + &quot;/&quot; + Labels.MEASUREMENTS + &quot;/&quot; + &quot;?sensor=&quot; + group.getId()
          + &quot;&amp;start=&quot; + DateConvert.convertDate(start) + &quot;&amp;end=&quot; + DateConvert.convertDate(end));
<span class="fc" id="L1212">      DepositoryMeasurementsResource resource = client.wrap(DepositoryMeasurementsResource.class);</span>
<span class="fc" id="L1213">      MeasurementList ret = resource.retrieve();</span>
<span class="fc" id="L1214">      client.release();</span>
<span class="fc" id="L1215">      return ret;</span>
    }
<span class="nc" id="L1217">    catch (DatatypeConfigurationException e) {</span>
<span class="nc" id="L1218">      e.printStackTrace();</span>
    }
<span class="nc" id="L1220">    return null;</span>
  }

  @Override
  public InterpolatedValueList getMinimumValues(Depository depository, Sensor sensor, Date start, Date end, Integer interval, Boolean usePointValues) throws NoMeasurementException {
<span class="nc" id="L1225">    ClientResource client = null;</span>
    try {
<span class="nc" id="L1227">      String valueType = Labels.DIFFERENCE;</span>
<span class="nc bnc" id="L1228" title="All 2 branches missed.">      if (usePointValues) {</span>
<span class="nc" id="L1229">        valueType = Labels.POINT;</span>
      }
<span class="nc" id="L1231">      client = makeClient(this.organizationId + &quot;/&quot; + Labels.DEPOSITORY + &quot;/&quot; + depository.getId()</span>
          + &quot;/&quot; + Labels.VALUES + &quot;/&quot; + Labels.MINIMUM + &quot;/&quot; + &quot;?sensor=&quot; + sensor.getId() + &quot;&amp;start=&quot;
          + DateConvert.convertDate(start) + &quot;&amp;end=&quot; + DateConvert.convertDate(end) + &quot;&amp;interval=&quot; + interval + &quot;&amp;value-type=&quot; + valueType);
<span class="nc" id="L1234">      DepositoryMinimumValuesResource resource = client.wrap(DepositoryMinimumValuesResource.class);</span>
<span class="nc" id="L1235">      InterpolatedValueList ret = resource.retrieve();</span>
<span class="nc" id="L1236">      client.release();</span>
<span class="nc" id="L1237">      return ret;</span>
    }
<span class="nc" id="L1239">    catch (ResourceException e1) {</span>
<span class="nc" id="L1240">      throw new NoMeasurementException(e1.getCause());</span>
    }
<span class="nc" id="L1242">    catch (DatatypeConfigurationException e) {</span>
<span class="nc" id="L1243">      e.printStackTrace();</span>
    }
    finally {
<span class="nc bnc" id="L1246" title="All 6 branches missed.">      if (client != null) {</span>
<span class="nc" id="L1247">        client.release();</span>
      }
    }
<span class="nc" id="L1250">    return null;</span>
  }

  @Override
  public InterpolatedValueList getMinimumValues(Depository depository, SensorGroup group, Date start, Date end, Integer interval, Boolean usePointValues) throws NoMeasurementException {
<span class="nc" id="L1255">    ClientResource client = null;</span>
    try {
<span class="nc" id="L1257">      String valueType = Labels.DIFFERENCE;</span>
<span class="nc bnc" id="L1258" title="All 2 branches missed.">      if (usePointValues) {</span>
<span class="nc" id="L1259">        valueType = Labels.POINT;</span>
      }
<span class="nc" id="L1261">      client = makeClient(this.organizationId + &quot;/&quot; + Labels.DEPOSITORY + &quot;/&quot; + depository.getId()</span>
          + &quot;/&quot; + Labels.VALUES + &quot;/&quot; + Labels.MINIMUM + &quot;/&quot; + &quot;?sensor=&quot; + group.getId() + &quot;&amp;start=&quot;
          + DateConvert.convertDate(start) + &quot;&amp;end=&quot; + DateConvert.convertDate(end) + &quot;&amp;interval=&quot; + interval + &quot;&amp;value-type=&quot; + valueType);
<span class="nc" id="L1264">      DepositoryMinimumValuesResource resource = client.wrap(DepositoryMinimumValuesResource.class);</span>
<span class="nc" id="L1265">      InterpolatedValueList ret = resource.retrieve();</span>
<span class="nc" id="L1266">      client.release();</span>
<span class="nc" id="L1267">      return ret;</span>
    }
<span class="nc" id="L1269">    catch (ResourceException e1) {</span>
<span class="nc" id="L1270">      throw new NoMeasurementException(e1.getCause());</span>
    }
<span class="nc" id="L1272">    catch (DatatypeConfigurationException e) {</span>
<span class="nc" id="L1273">      e.printStackTrace();</span>
    }
    finally {
<span class="nc bnc" id="L1276" title="All 6 branches missed.">      if (client != null) {</span>
<span class="nc" id="L1277">        client.release();</span>
      }
    }
<span class="nc" id="L1280">    return null;</span>
  }

  /**
   * @return the organization id.
   */
  public String getOrganizationId() {
<span class="fc" id="L1287">    return organizationId;</span>
  }

  /*
   * (non-Javadoc)
   *
   * @see org.wattdepot.client.WattDepotInterface#getSensor(java.lang.String)
   */
  @Override
  public Sensor getSensor(String id) throws IdNotFoundException {
<span class="fc" id="L1297">    ClientResource client = makeClient(this.organizationId + &quot;/&quot; + Labels.SENSOR + &quot;/&quot; + id);</span>
<span class="fc" id="L1298">    SensorResource resource = client.wrap(SensorResource.class);</span>
    try {
<span class="fc" id="L1300">      Sensor ret = resource.retrieve();</span>
<span class="fc" id="L1301">      client.release();</span>
<span class="fc" id="L1302">      return ret;</span>
    }
<span class="fc" id="L1304">    catch (ResourceException e) {</span>
<span class="fc" id="L1305">      throw new IdNotFoundException(id + &quot; is not a known Sensor. &quot;);</span>
    }
    finally {
<span class="pc bpc" id="L1308" title="2 of 4 branches missed.">      if (client != null) {</span>
<span class="fc" id="L1309">        client.release();</span>
      }
    }
  }

  /*
   * (non-Javadoc)
   *
   * @see
   * org.wattdepot.client.WattDepotInterface#getSensorGroup(java.lang.String)
   */
  @Override
  public SensorGroup getSensorGroup(String id) throws IdNotFoundException {
<span class="fc" id="L1322">    ClientResource client = makeClient(this.organizationId + &quot;/&quot; + Labels.SENSOR_GROUP + &quot;/&quot; + id);</span>
<span class="fc" id="L1323">    SensorGroupResource resource = client.wrap(SensorGroupResource.class);</span>
    try {
<span class="fc" id="L1325">      SensorGroup ret = resource.retrieve();</span>
<span class="fc" id="L1326">      client.release();</span>
<span class="fc" id="L1327">      return ret;</span>
    }
<span class="fc" id="L1329">    catch (ResourceException e) {</span>
<span class="fc" id="L1330">      throw new IdNotFoundException(id + &quot; is not a known SensorGroup. &quot;);</span>
    }
    finally {
<span class="pc bpc" id="L1333" title="2 of 4 branches missed.">      if (client != null) {</span>
<span class="fc" id="L1334">        client.release();</span>
      }
    }
  }

  /*
   * (non-Javadoc)
   *
   * @see org.wattdepot.client.WattDepotInterface#getSensorGroups()
   */
  @Override
  public SensorGroupList getSensorGroups() {
<span class="fc" id="L1346">    ClientResource client = makeClient(this.organizationId + &quot;/&quot; + Labels.SENSOR_GROUPS + &quot;/&quot;);</span>
<span class="fc" id="L1347">    SensorGroupsResource resource = client.wrap(SensorGroupsResource.class);</span>
<span class="fc" id="L1348">    SensorGroupList ret = resource.retrieve();</span>
<span class="fc" id="L1349">    client.release();</span>
<span class="fc" id="L1350">    return ret;</span>

  }

  /*
   * (non-Javadoc)
   *
   * @see
   * org.wattdepot.client.WattDepotInterface#getSensorModel(java.lang.String)
   */
  @Override
  public SensorModel getSensorModel(String id) throws IdNotFoundException {
<span class="fc" id="L1362">    ClientResource client = makeClient(Labels.PUBLIC + &quot;/&quot; + Labels.SENSOR_MODEL + &quot;/&quot; + id);</span>
<span class="fc" id="L1363">    SensorModelResource resource = client.wrap(SensorModelResource.class);</span>
    try {
<span class="fc" id="L1365">      SensorModel ret = resource.retrieve();</span>
<span class="fc" id="L1366">      client.release();</span>
<span class="fc" id="L1367">      return ret;</span>
    }
<span class="fc" id="L1369">    catch (ResourceException e) {</span>
<span class="fc" id="L1370">      throw new IdNotFoundException(id + &quot; is not a known SensorModel. &quot;);</span>
    }
    finally {
<span class="pc bpc" id="L1373" title="2 of 4 branches missed.">      if (client != null) {</span>
<span class="fc" id="L1374">        client.release();</span>
      }
    }
  }

  /*
   * (non-Javadoc)
   *
   * @see org.wattdepot.client.WattDepotInterface#getSensorModels()
   */
  @Override
  public SensorModelList getSensorModels() {
<span class="fc" id="L1386">    ClientResource client = makeClient(Labels.PUBLIC + &quot;/&quot; + Labels.SENSOR_MODELS + &quot;/&quot;);</span>
<span class="fc" id="L1387">    SensorModelsResource resource = client.wrap(SensorModelsResource.class);</span>
<span class="fc" id="L1388">    SensorModelList ret = resource.retrieve();</span>
<span class="fc" id="L1389">    client.release();</span>
<span class="fc" id="L1390">    return ret;</span>
  }

  @Override
  public SensorStatus getSensorStatus(Depository depository, Sensor sensor) {
<span class="nc" id="L1395">    ClientResource client = null;</span>
    try {
<span class="nc" id="L1397">      client = makeClient(this.organizationId + &quot;/&quot; + Labels.DEPOSITORY + &quot;/&quot; + depository.getId()</span>
          + &quot;/&quot; + Labels.SENSOR_STATUS + &quot;/&quot; + &quot;?sensor=&quot; + sensor.getId());
<span class="nc" id="L1399">      DepositorySensorStatusResource resource = client.wrap(DepositorySensorStatusResource.class);</span>
<span class="nc" id="L1400">      SensorStatusList list = resource.retrieve();</span>
<span class="nc" id="L1401">      client.release();</span>
<span class="nc bnc" id="L1402" title="All 2 branches missed.">      if (list != null) {</span>
<span class="nc" id="L1403">        return list.getStatuses().get(0);</span>
      }
    }
    finally {
<span class="nc bnc" id="L1407" title="All 6 branches missed.">      if (client != null) {</span>
<span class="nc" id="L1408">        client.release();</span>
      }
    }
<span class="nc" id="L1411">    return null;</span>
  }

  @Override
  public SensorStatusList getSensorStatuses(Depository depository, SensorGroup group) {
<span class="nc" id="L1416">    ClientResource client = null;</span>
    try {
<span class="nc" id="L1418">      client = makeClient(this.organizationId + &quot;/&quot; + Labels.DEPOSITORY + &quot;/&quot; + depository.getId()</span>
          + &quot;/&quot; + Labels.SENSOR_STATUS + &quot;/&quot; + &quot;?sensor=&quot; + group.getId());
<span class="nc" id="L1420">      DepositorySensorStatusResource resource = client.wrap(DepositorySensorStatusResource.class);</span>
<span class="nc" id="L1421">      SensorStatusList list = resource.retrieve();</span>
<span class="nc" id="L1422">      client.release();</span>
<span class="nc bnc" id="L1423" title="All 2 branches missed.">      if (list != null) {</span>
<span class="nc" id="L1424">        return list;</span>
      }
    }
    finally {
<span class="nc bnc" id="L1428" title="All 6 branches missed.">      if (client != null) {</span>
<span class="nc" id="L1429">        client.release();</span>
      }
    }
<span class="nc" id="L1432">    return null;</span>
  }

  /*
   * (non-Javadoc)
   *
   * @see org.wattdepot.client.WattDepotInterface#getSensors()
   */
  @Override
  public SensorList getSensors() {
<span class="fc" id="L1442">    ClientResource client = makeClient(this.organizationId + &quot;/&quot; + Labels.SENSORS + &quot;/&quot;);</span>
<span class="fc" id="L1443">    SensorsResource resource = client.wrap(SensorsResource.class);</span>
<span class="fc" id="L1444">    SensorList ret = resource.retrieve();</span>
<span class="fc" id="L1445">    client.release();</span>
<span class="fc" id="L1446">    return ret;</span>
  }

  /*
   * (non-Javadoc)
   *
   * @see
   * org.wattdepot.client.WattDepotInterface#getValue(org.wattdepot.datamodel
   * .Depository, org.wattdepot.datamodel.Sensor, java.util.Date)
   */
  @Override
  public Double getValue(Depository depository, Sensor sensor, Date timestamp)
      throws NoMeasurementException {
<span class="fc" id="L1459">    ClientResource client = null;</span>
    try {
<span class="fc" id="L1461">      client = makeClient(this.organizationId + &quot;/&quot; + Labels.DEPOSITORY + &quot;/&quot; + depository.getId()</span>
          + &quot;/&quot; + Labels.VALUE + &quot;/&quot; + &quot;?sensor=&quot; + sensor.getId() + &quot;&amp;timestamp=&quot;
          + DateConvert.convertDate(timestamp));
<span class="fc" id="L1464">      DepositoryValueResource resource = client.wrap(DepositoryValueResource.class);</span>
<span class="fc" id="L1465">      InterpolatedValue ret = resource.retrieve();</span>
<span class="fc" id="L1466">      client.release();</span>
<span class="pc bpc" id="L1467" title="1 of 2 branches missed.">      if (ret != null) {</span>
<span class="fc" id="L1468">        return ret.getValue();</span>
      }
    }
<span class="nc" id="L1471">    catch (DatatypeConfigurationException e) {</span>
<span class="nc" id="L1472">      throw new NoMeasurementException(e.getMessage());</span>
    }
    finally {
<span class="pc bpc" id="L1475" title="5 of 6 branches missed.">      if (client != null) {</span>
<span class="pc" id="L1476">        client.release();</span>
      }
    }
<span class="nc" id="L1479">    return null;</span>
  }

  /*
   * (non-Javadoc)
   *
   * @see
   * org.wattdepot.client.WattDepotInterface#getValue(org.wattdepot.datamodel
   * .Depository, org.wattdepot.datamodel.Sensor, java.util.Date,
   * java.util.Date)
   */
  @Override
  public Double getValue(Depository depository, Sensor sensor, Date start, Date end)
      throws NoMeasurementException {
<span class="fc" id="L1493">    ClientResource client = null;</span>
    try {
<span class="fc" id="L1495">      client = makeClient(this.organizationId + &quot;/&quot; + Labels.DEPOSITORY + &quot;/&quot; + depository.getId()</span>
          + &quot;/&quot; + Labels.VALUE + &quot;/&quot; + &quot;?sensor=&quot; + sensor.getId() + &quot;&amp;start=&quot;
          + DateConvert.convertDate(start) + &quot;&amp;end=&quot; + DateConvert.convertDate(end));
<span class="fc" id="L1498">      DepositoryValueResource resource = client.wrap(DepositoryValueResource.class);</span>
<span class="fc" id="L1499">      InterpolatedValue ret = resource.retrieve();</span>
<span class="fc" id="L1500">      client.release();</span>
<span class="fc" id="L1501">      return ret.getValue();</span>
    }
<span class="nc" id="L1503">    catch (DatatypeConfigurationException e) {</span>
<span class="nc" id="L1504">      e.printStackTrace();</span>
    }
    finally {
<span class="pc bpc" id="L1507" title="5 of 6 branches missed.">      if (client != null) {</span>
<span class="pc" id="L1508">        client.release();</span>
      }
    }
<span class="nc" id="L1511">    return null;</span>
  }

  /*
   * (non-Javadoc)
   *
   * @see
   * org.wattdepot.client.WattDepotInterface#getValue(org.wattdepot.datamodel
   * .Depository, org.wattdepot.datamodel.Sensor, java.util.Date,
   * java.util.Date, java.lang.Long)
   */
  @Override
  public Double getValue(Depository depository, Sensor sensor, Date start, Date end, Long gapSeconds)
      throws NoMeasurementException, MeasurementGapException {
<span class="fc" id="L1525">    ClientResource client = null;</span>
    try {
<span class="fc" id="L1527">      client = makeClient(this.organizationId + &quot;/&quot; + Labels.DEPOSITORY + &quot;/&quot; + depository.getId()</span>
          + &quot;/&quot; + Labels.VALUE + &quot;/&quot; + &quot;?sensor=&quot; + sensor.getId() + &quot;&amp;start=&quot;
          + DateConvert.convertDate(start) + &quot;&amp;end=&quot; + DateConvert.convertDate(end) + &quot;&amp;gap=&quot;
          + gapSeconds);
<span class="fc" id="L1531">      DepositoryValueResource resource = client.wrap(DepositoryValueResource.class);</span>
<span class="fc" id="L1532">      InterpolatedValue ret = resource.retrieve();</span>
<span class="fc" id="L1533">      client.release();</span>
<span class="fc" id="L1534">      return ret.getValue();</span>
    }
<span class="nc" id="L1536">    catch (DatatypeConfigurationException e) {</span>
<span class="nc" id="L1537">      e.printStackTrace();</span>
    }
    finally {
<span class="pc bpc" id="L1540" title="5 of 6 branches missed.">      if (client != null) {</span>
<span class="pc" id="L1541">        client.release();</span>
      }
    }
<span class="nc" id="L1544">    return null;</span>
  }

  /*
   * (non-Javadoc)
   *
   * @see
   * org.wattdepot.client.WattDepotInterface#getValue(org.wattdepot.datamodel
   * .Depository, org.wattdepot.datamodel.Sensor, java.util.Date,
   * java.lang.Long)
   */
  @Override
  public Double getValue(Depository depository, Sensor sensor, Date timestamp, Long gapSeconds)
      throws NoMeasurementException, MeasurementGapException {
<span class="fc" id="L1558">    ClientResource client = null;</span>
    try {
<span class="fc" id="L1560">      client = makeClient(this.organizationId + &quot;/&quot; + Labels.DEPOSITORY + &quot;/&quot; + depository.getId()</span>
          + &quot;/&quot; + Labels.VALUE + &quot;/&quot; + &quot;?sensor=&quot; + sensor.getId() + &quot;&amp;timestamp=&quot;
          + DateConvert.convertDate(timestamp) + &quot;&amp;gap=&quot; + gapSeconds);
<span class="fc" id="L1563">      DepositoryValueResource resource = client.wrap(DepositoryValueResource.class);</span>
<span class="fc" id="L1564">      InterpolatedValue ret = resource.retrieve();</span>
<span class="fc" id="L1565">      client.release();</span>
<span class="fc" id="L1566">      return ret.getValue();</span>
    }
<span class="nc" id="L1568">    catch (DatatypeConfigurationException e) {</span>
<span class="nc" id="L1569">      e.printStackTrace();</span>
    }
    finally {
<span class="pc bpc" id="L1572" title="5 of 6 branches missed.">      if (client != null) {</span>
<span class="pc" id="L1573">        client.release();</span>
      }
    }
<span class="nc" id="L1576">    return null;</span>
  }

  /*
   * (non-Javadoc)
   *
   * @see
   * org.wattdepot.client.WattDepotInterface#getValue(org.wattdepot.datamodel
   * .Depository, org.wattdepot.datamodel.SensorGroup, java.util.Date)
   */
  @Override
  public Double getValue(Depository depository, SensorGroup group, Date timestamp)
      throws NoMeasurementException {
<span class="fc" id="L1589">    ClientResource client = null;</span>
    try {
<span class="fc" id="L1591">      client = makeClient(this.organizationId + &quot;/&quot; + Labels.DEPOSITORY + &quot;/&quot; + depository.getId()</span>
          + &quot;/&quot; + Labels.VALUE + &quot;/&quot; + &quot;?sensor=&quot; + group.getId() + &quot;&amp;timestamp=&quot;
          + DateConvert.convertDate(timestamp));
<span class="fc" id="L1594">      DepositoryValueResource resource = client.wrap(DepositoryValueResource.class);</span>
<span class="fc" id="L1595">      InterpolatedValue ret = resource.retrieve();</span>
<span class="fc" id="L1596">      client.release();</span>
<span class="pc bpc" id="L1597" title="1 of 2 branches missed.">      if (ret != null) {</span>
<span class="fc" id="L1598">        return ret.getValue();</span>
      }
    }
<span class="fc" id="L1601">    catch (ResourceException re) {</span>
<span class="fc" id="L1602">      throw new NoMeasurementException(re.getMessage());</span>
    }
<span class="nc" id="L1604">    catch (DatatypeConfigurationException e) {</span>
<span class="nc" id="L1605">      throw new NoMeasurementException(e.getMessage());</span>
    }
    finally {
<span class="pc bpc" id="L1608" title="4 of 6 branches missed.">      if (client != null) {</span>
<span class="pc" id="L1609">        client.release();</span>
      }
    }
<span class="nc" id="L1612">    return null;</span>
  }

  /*
   * (non-Javadoc)
   *
   * @see org.wattdepot.client.WattDepotInterface#getValue(org.wattdepot.common.
   * domainmodel.Depository, org.wattdepot.common.domainmodel.SensorGroup,
   * java.util.Date, java.util.Date)
   */
  @Override
  public Double getValue(Depository depository, SensorGroup group, Date start, Date end)
      throws NoMeasurementException {
<span class="fc" id="L1625">    ClientResource client = null;</span>
    try {
<span class="fc" id="L1627">      client = makeClient(this.organizationId + &quot;/&quot; + Labels.DEPOSITORY + &quot;/&quot; + depository.getId()</span>
          + &quot;/&quot; + Labels.VALUE + &quot;/&quot; + &quot;?sensor=&quot; + group.getId() + &quot;&amp;start=&quot;
          + DateConvert.convertDate(start) + &quot;&amp;end=&quot; + DateConvert.convertDate(end));
<span class="fc" id="L1630">      DepositoryValueResource resource = client.wrap(DepositoryValueResource.class);</span>
<span class="fc" id="L1631">      InterpolatedValue ret = resource.retrieve();</span>
<span class="fc" id="L1632">      client.release();</span>
<span class="fc" id="L1633">      return ret.getValue();</span>
    }
<span class="nc" id="L1635">    catch (ResourceException re) {</span>
<span class="nc" id="L1636">      throw new  NoMeasurementException(re.getCause());</span>
    }
<span class="nc" id="L1638">    catch (DatatypeConfigurationException e) {</span>
<span class="nc" id="L1639">      e.printStackTrace();</span>
    }
    finally {
<span class="pc bpc" id="L1642" title="5 of 6 branches missed.">      if (client != null) {</span>
<span class="pc" id="L1643">        client.release();</span>
      }
    }
<span class="nc" id="L1646">    return null;</span>
  }

  /*
   * (non-Javadoc)
   *
   * @see org.wattdepot.client.WattDepotInterface#getValue(org.wattdepot.common.
   * domainmodel.Depository, org.wattdepot.common.domainmodel.SensorGroup,
   * java.util.Date, java.util.Date, java.lang.Long)
   */
  @Override
  public Double getValue(Depository depository, SensorGroup group, Date start, Date end,
      Long gapSeconds) throws NoMeasurementException, MeasurementGapException {
<span class="fc" id="L1659">    ClientResource client = null;</span>
    try {
<span class="fc" id="L1661">      client = makeClient(this.organizationId + &quot;/&quot; + Labels.DEPOSITORY + &quot;/&quot; + depository.getId()</span>
          + &quot;/&quot; + Labels.VALUE + &quot;/&quot; + &quot;?sensor=&quot; + group.getId() + &quot;&amp;start=&quot;
          + DateConvert.convertDate(start) + &quot;&amp;end=&quot; + DateConvert.convertDate(end) + &quot;&amp;gap=&quot;
          + gapSeconds);
<span class="fc" id="L1665">      DepositoryValueResource resource = client.wrap(DepositoryValueResource.class);</span>
<span class="fc" id="L1666">      InterpolatedValue ret = resource.retrieve();</span>
<span class="fc" id="L1667">      client.release();</span>
<span class="fc" id="L1668">      return ret.getValue();</span>
    }
<span class="nc" id="L1670">    catch (ResourceException re) {</span>
<span class="nc" id="L1671">      throw new MeasurementGapException(re.getCause());</span>
    }
<span class="nc" id="L1673">    catch (DatatypeConfigurationException e) {</span>
<span class="nc" id="L1674">      e.printStackTrace();</span>
    }
    finally {
<span class="pc bpc" id="L1677" title="5 of 6 branches missed.">      if (client != null) {</span>
<span class="pc" id="L1678">        client.release();</span>
      }
    }
<span class="nc" id="L1681">    return null;</span>
  }

  /*
   * (non-Javadoc)
   *
   * @see org.wattdepot.client.WattDepotInterface#getValue(org.wattdepot.common.
   * domainmodel.Depository, org.wattdepot.common.domainmodel.SensorGroup,
   * java.util.Date, java.lang.Long)
   */
  @Override
  public Double getValue(Depository depository, SensorGroup group, Date timestamp, Long gapSeconds)
      throws NoMeasurementException, MeasurementGapException {
<span class="fc" id="L1694">    ClientResource client = null;</span>
    try {
<span class="fc" id="L1696">      client = makeClient(this.organizationId + &quot;/&quot; + Labels.DEPOSITORY + &quot;/&quot; + depository.getId()</span>
          + &quot;/&quot; + Labels.VALUE + &quot;/&quot; + &quot;?sensor=&quot; + group.getId() + &quot;&amp;timestamp=&quot;
          + DateConvert.convertDate(timestamp) + &quot;&amp;gap=&quot; + gapSeconds);
<span class="fc" id="L1699">      DepositoryValueResource resource = client.wrap(DepositoryValueResource.class);</span>
<span class="fc" id="L1700">      InterpolatedValue ret = resource.retrieve();</span>
<span class="fc" id="L1701">      client.release();</span>
<span class="fc" id="L1702">      return ret.getValue();</span>
    }
<span class="fc" id="L1704">    catch (ResourceException e1) {</span>
<span class="fc" id="L1705">      throw new MeasurementGapException(e1.getCause());</span>
    }
<span class="nc" id="L1707">    catch (DatatypeConfigurationException e) {</span>
<span class="nc" id="L1708">      e.printStackTrace();</span>
    }
    finally {
<span class="pc bpc" id="L1711" title="4 of 6 branches missed.">      if (client != null) {</span>
<span class="pc" id="L1712">        client.release();</span>
      }
    }
<span class="nc" id="L1715">    return null;</span>
  }

  /*
   * (non-Javadoc)
   *
   * @see org.wattdepot.client.WattDepotInterface#getValue(org.wattdepot.common.
   * domainmodel.Depository, org.wattdepot.common.domainmodel.Sensor,
   * java.util.Date, java.util.Date, java.lang.Integer, java.lang.Boolean)
   */
  @Override
  public InterpolatedValueList getValues(Depository depository, Sensor sensor, Date start, Date end, Integer interval, Boolean usePointValues) throws NoMeasurementException {
<span class="fc" id="L1727">    ClientResource client = null;</span>
    try {
<span class="fc" id="L1729">      StringBuilder sb = new StringBuilder();</span>
<span class="fc" id="L1730">      sb.append(this.organizationId);</span>
<span class="fc" id="L1731">      sb.append(&quot;/&quot;);</span>
<span class="fc" id="L1732">      sb.append(Labels.DEPOSITORY);</span>
<span class="fc" id="L1733">      sb.append(&quot;/&quot;);</span>
<span class="fc" id="L1734">      sb.append(depository.getId());</span>
<span class="fc" id="L1735">      sb.append(&quot;/&quot;);</span>
<span class="fc" id="L1736">      sb.append(Labels.VALUES);</span>
<span class="fc" id="L1737">      sb.append(&quot;/?&quot;);</span>
<span class="fc" id="L1738">      sb.append(Labels.SENSOR);</span>
<span class="fc" id="L1739">      sb.append(&quot;=&quot;);</span>
<span class="fc" id="L1740">      sb.append(sensor.getId());</span>
<span class="fc" id="L1741">      sb.append(&quot;&amp;&quot;);</span>
<span class="fc" id="L1742">      sb.append(Labels.START);</span>
<span class="fc" id="L1743">      sb.append(&quot;=&quot;);</span>
<span class="fc" id="L1744">      sb.append(DateConvert.convertDate(start));</span>
<span class="fc" id="L1745">      sb.append(&quot;&amp;&quot;);</span>
<span class="fc" id="L1746">      sb.append(Labels.END);</span>
<span class="fc" id="L1747">      sb.append(&quot;=&quot;);</span>
<span class="fc" id="L1748">      sb.append(DateConvert.convertDate(end));</span>
<span class="fc" id="L1749">      sb.append(&quot;&amp;&quot;);</span>
<span class="fc" id="L1750">      sb.append(Labels.INTERVAL);</span>
<span class="fc" id="L1751">      sb.append(&quot;=&quot;);</span>
<span class="fc" id="L1752">      sb.append(interval);</span>
<span class="fc" id="L1753">      sb.append(&quot;&amp;&quot;);</span>
<span class="fc" id="L1754">      sb.append(Labels.VALUE_TYPE);</span>
<span class="fc" id="L1755">      sb.append(&quot;=&quot;);</span>
<span class="fc bfc" id="L1756" title="All 2 branches covered.">      if (usePointValues) {</span>
<span class="fc" id="L1757">        sb.append(Labels.POINT);</span>
      }
      else {
<span class="fc" id="L1760">        sb.append(Labels.DIFFERENCE);</span>
      }
<span class="fc" id="L1762">      client = makeClient(sb.toString());</span>
<span class="fc" id="L1763">      DepositoryValuesResource resource = client.wrap(DepositoryValuesResource.class);</span>
<span class="fc" id="L1764">      InterpolatedValueList ret = resource.retrieve();</span>
<span class="fc" id="L1765">      client.release();</span>
<span class="fc" id="L1766">      return ret;</span>
    }
<span class="nc" id="L1768">    catch (DatatypeConfigurationException e) {</span>
<span class="nc" id="L1769">      e.printStackTrace();</span>
    }
    finally {
<span class="pc bpc" id="L1772" title="5 of 6 branches missed.">      if (client != null) {</span>
<span class="pc" id="L1773">        client.release();</span>
      }
    }
<span class="nc" id="L1776">    return null;</span>
  }

  /*
   * (non-Javadoc)
   *
   * @see org.wattdepot.client.WattDepotInterface#getValue(org.wattdepot.common.
   * domainmodel.Depository, org.wattdepot.common.domainmodel.SensorGroup,
   * java.util.Date, java.util.Date, java.lang.Integer, java.lang.Boolean)
   */
  @Override
  public InterpolatedValueList getValues(Depository depository, SensorGroup group, Date start, Date end, Integer interval, Boolean usePointValues) throws NoMeasurementException {
<span class="fc" id="L1788">    ClientResource client = null;</span>
    try {
<span class="fc" id="L1790">      StringBuilder sb = new StringBuilder();</span>
<span class="fc" id="L1791">      sb.append(this.organizationId);</span>
<span class="fc" id="L1792">      sb.append(&quot;/&quot;);</span>
<span class="fc" id="L1793">      sb.append(Labels.DEPOSITORY);</span>
<span class="fc" id="L1794">      sb.append(&quot;/&quot;);</span>
<span class="fc" id="L1795">      sb.append(depository.getId());</span>
<span class="fc" id="L1796">      sb.append(&quot;/&quot;);</span>
<span class="fc" id="L1797">      sb.append(Labels.VALUES);</span>
<span class="fc" id="L1798">      sb.append(&quot;/?&quot;);</span>
<span class="fc" id="L1799">      sb.append(Labels.SENSOR);</span>
<span class="fc" id="L1800">      sb.append(&quot;=&quot;);</span>
<span class="fc" id="L1801">      sb.append(group.getId());</span>
<span class="fc" id="L1802">      sb.append(&quot;&amp;&quot;);</span>
<span class="fc" id="L1803">      sb.append(Labels.START);</span>
<span class="fc" id="L1804">      sb.append(&quot;=&quot;);</span>
<span class="fc" id="L1805">      sb.append(DateConvert.convertDate(start));</span>
<span class="fc" id="L1806">      sb.append(&quot;&amp;&quot;);</span>
<span class="fc" id="L1807">      sb.append(Labels.END);</span>
<span class="fc" id="L1808">      sb.append(&quot;=&quot;);</span>
<span class="fc" id="L1809">      sb.append(DateConvert.convertDate(end));</span>
<span class="fc" id="L1810">      sb.append(&quot;&amp;&quot;);</span>
<span class="fc" id="L1811">      sb.append(Labels.INTERVAL);</span>
<span class="fc" id="L1812">      sb.append(&quot;=&quot;);</span>
<span class="fc" id="L1813">      sb.append(interval);</span>
<span class="fc" id="L1814">      sb.append(&quot;&amp;&quot;);</span>
<span class="fc" id="L1815">      sb.append(Labels.VALUE_TYPE);</span>
<span class="fc" id="L1816">      sb.append(&quot;=&quot;);</span>
<span class="pc bpc" id="L1817" title="1 of 2 branches missed.">      if (usePointValues) {</span>
<span class="nc" id="L1818">        sb.append(Labels.POINT);</span>
      }
      else {
<span class="fc" id="L1821">        sb.append(Labels.DIFFERENCE);</span>
      }
<span class="fc" id="L1823">      client = makeClient(sb.toString());</span>
<span class="fc" id="L1824">      DepositoryValuesResource resource = client.wrap(DepositoryValuesResource.class);</span>
<span class="fc" id="L1825">      InterpolatedValueList ret = resource.retrieve();</span>
<span class="fc" id="L1826">      client.release();</span>
<span class="fc" id="L1827">      return ret;</span>
    }
<span class="nc" id="L1829">    catch (DatatypeConfigurationException e) {</span>
<span class="nc" id="L1830">      e.printStackTrace();</span>
    }
    finally {
<span class="pc bpc" id="L1833" title="5 of 6 branches missed.">      if (client != null) {</span>
<span class="pc" id="L1834">        client.release();</span>
      }
    }
<span class="nc" id="L1837">    return null;</span>
  }

  /**
   * @return the wattDepotUri
   */
  public String getWattDepotUri() {
<span class="fc" id="L1844">    return wattDepotUri;</span>
  }

  /*
   * (non-Javadoc)
   * 
   * @see
   * org.wattdepot.client.WattDepotInterface#isDefinedCollectorProcessDefinition
   * (java.lang.String)
   */
  @Override
  public boolean isDefinedCollectorProcessDefinition(String id) {
    try {
<span class="fc" id="L1857">      getCollectorProcessDefinition(id);</span>
<span class="fc" id="L1858">      return true;</span>
    }
<span class="fc" id="L1860">    catch (IdNotFoundException e) {</span>
<span class="fc" id="L1861">      return false;</span>
    }
  }

  /*
   * (non-Javadoc)
   * 
   * @see
   * org.wattdepot.client.WattDepotInterface#isDefinedDepository(java.lang.String
   * )
   */
  @Override
  public boolean isDefinedDepository(String id) {
    try {
<span class="fc" id="L1875">      getDepository(id);</span>
<span class="fc" id="L1876">      return true;</span>
    }
<span class="fc" id="L1878">    catch (IdNotFoundException e) {</span>
<span class="fc" id="L1879">      return false;</span>
    }
  }

  /*
   * (non-Javadoc)
   * 
   * @see
   * org.wattdepot.client.WattDepotInterface#isDefinedMeasurementPruningDefinition
   * (java.lang.String)
   */
  @Override
  public boolean isDefinedMeasurementPruningDefinition(String id) {
    try {
<span class="fc" id="L1893">      getMeasurementPruningDefinition(id);</span>
<span class="fc" id="L1894">      return true;</span>
    }
<span class="fc" id="L1896">    catch (IdNotFoundException idnf) {</span>
<span class="fc" id="L1897">      return false;</span>
    }
  }

  /*
   * (non-Javadoc)
   * 
   * @see
   * org.wattdepot.client.WattDepotInterface#isDefinedMeasurementType(java.lang
   * .String)
   */
  @Override
  public boolean isDefinedMeasurementType(String id) {
    try {
<span class="fc" id="L1911">      getMeasurementType(id);</span>
<span class="fc" id="L1912">      return true;</span>
    }
<span class="fc" id="L1914">    catch (IdNotFoundException e) {</span>
<span class="fc" id="L1915">      return false;</span>
    }
  }

  /*
   * (non-Javadoc)
   * 
   * @see
   * org.wattdepot.client.WattDepotInterface#isDefinedSensor(java.lang.String)
   */
  @Override
  public boolean isDefinedSensor(String id) {
    try {
<span class="fc" id="L1928">      getSensor(id);</span>
<span class="fc" id="L1929">      return true;</span>
    }
<span class="fc" id="L1931">    catch (IdNotFoundException e) {</span>
<span class="fc" id="L1932">      return false;</span>
    }
  }

  /*
   * (non-Javadoc)
   * 
   * @see
   * org.wattdepot.client.WattDepotInterface#isDefinedSensorGroup(java.lang.
   * String)
   */
  @Override
  public boolean isDefinedSensorGroup(String id) {
    try {
<span class="fc" id="L1946">      getSensorGroup(id);</span>
<span class="fc" id="L1947">      return true;</span>
    }
<span class="fc" id="L1949">    catch (IdNotFoundException e) {</span>
<span class="fc" id="L1950">      return false;</span>
    }
  }

  /*
   * (non-Javadoc)
   * 
   * @see
   * org.wattdepot.client.WattDepotInterface#isDefinedSensorModel(java.lang.
   * String)
   */
  @Override
  public boolean isDefinedSensorModel(String id) {
    try {
<span class="fc" id="L1964">      getSensorModel(id);</span>
<span class="fc" id="L1965">      return true;</span>
    }
<span class="fc" id="L1967">    catch (IdNotFoundException e) {</span>
<span class="fc" id="L1968">      return false;</span>
    }
  }

  /*
   * (non-Javadoc)
   * 
   * @see org.wattdepot.client.WattDepotInterface#isHealthy()
   */
  @Override
  public boolean isHealthy() {
<span class="fc" id="L1979">    ClientResource client = makeClient(&quot;&quot;);</span>
<span class="fc" id="L1980">    client.head();</span>
<span class="fc" id="L1981">    boolean healthy = client.getStatus().isSuccess();</span>
<span class="fc" id="L1982">    client.release();</span>
<span class="fc" id="L1983">    return healthy;</span>
  }

  /**
   * Creates a ClientResource for the given request. Calling code MUST release
   * the ClientResource when finished.
   * 
   * @param requestString A String, the request portion of the WattDepot HTTP
   *        API, such as &quot;
   * @return The client resource.
   */
  public ClientResource makeClient(String requestString) {
<span class="fc" id="L1995">    logger.fine(this.wattDepotUri + requestString);</span>
<span class="fc" id="L1996">    Reference reference = new Reference(this.wattDepotUri + requestString);</span>
<span class="fc" id="L1997">    ClientResource client = new ClientResource(reference);</span>
<span class="fc" id="L1998">    client.setChallengeResponse(authentication);</span>
<span class="fc" id="L1999">    return client;</span>
  }

  /*
   * (non-Javadoc)
   * 
   * @see
   * org.wattdepot.client.WattDepotInterface#putCollectorProcessDefinition(org
   * .wattdepot .datamodel.CollectorProcessDefinition)
   */
  @Override
  public void putCollectorProcessDefinition(CollectorProcessDefinition process) {
<span class="fc" id="L2011">    ClientResource client = makeClient(this.organizationId + &quot;/&quot;</span>
        + Labels.COLLECTOR_PROCESS_DEFINITION + &quot;/&quot;);
<span class="fc" id="L2013">    CollectorProcessDefinitionPutResource resource = client</span>
        .wrap(CollectorProcessDefinitionPutResource.class);
    try {
<span class="fc" id="L2016">      resource.store(process);</span>
    }
    finally {
<span class="pc" id="L2019">      client.release();</span>
<span class="fc" id="L2020">    }</span>
<span class="fc" id="L2021">  }</span>

  /*
   * (non-Javadoc)
   * 
   * @see
   * org.wattdepot.client.WattDepotInterface#putDepository(org.wattdepot.datamodel
   * .Depository)
   */
  @Override
  public void putDepository(Depository depository) {
<span class="fc" id="L2032">    ClientResource client = makeClient(this.organizationId + &quot;/&quot; + Labels.DEPOSITORY + &quot;/&quot;);</span>
<span class="fc" id="L2033">    DepositoryPutResource resource = client.wrap(DepositoryPutResource.class);</span>
    try {
<span class="fc" id="L2035">      resource.store(depository);</span>
    }
    finally {
<span class="fc" id="L2038">      client.release();</span>
<span class="fc" id="L2039">    }</span>
<span class="fc" id="L2040">  }</span>

  /*
   * (non-Javadoc)
   *
   * @see org.wattdepot.client.WattDepotInterface#putMeasurement(org.wattdepot.
   * datamodel.Depository, org.wattdepot.datamodel.Measurement)
   */
  @Override
  public void putMeasurement(Depository depository, Measurement measurement)
      throws MeasurementTypeException {
<span class="fc bfc" id="L2051" title="All 2 branches covered.">    if (!depository.getMeasurementType().getUnits().equals(measurement.getMeasurementType())) {</span>
<span class="fc" id="L2052">      throw new MeasurementTypeException(&quot;Depository &quot; + depository.getName() + &quot; stores &quot;</span>
          + depository.getMeasurementType() + &quot; not &quot; + measurement.getMeasurementType());
    }
<span class="fc" id="L2055">    ClientResource client = makeClient(this.organizationId + &quot;/&quot; + Labels.DEPOSITORY + &quot;/&quot;</span>
        + depository.getId() + &quot;/&quot; + Labels.MEASUREMENT + &quot;/&quot;);
<span class="fc" id="L2057">    DepositoryMeasurementPutResource resource = client.wrap(DepositoryMeasurementPutResource.class);</span>
    try {
<span class="fc" id="L2059">      resource.store(measurement);</span>
    }
    finally {
<span class="pc" id="L2062">      client.release();</span>
<span class="fc" id="L2063">    }</span>
<span class="fc" id="L2064">  }</span>

  /*
   * (non-Javadoc)
   *
   * @see
   * org.wattdepot.client.WattDepotInterface#putMeasurementPruningDefinition(
   * org.wattdepot.common.domainmodel.MeasurementPruningDefinition)
   */
  @Override
  public void putMeasurementPruningDefinition(MeasurementPruningDefinition gcd) {
<span class="fc" id="L2075">    String url = this.organizationId + &quot;/&quot;</span>
        + Labels.MEASUREMENT_PRUNING_DEFINITION + &quot;/&quot;;
<span class="fc" id="L2077">    ClientResource client = makeClient(url);</span>
<span class="fc" id="L2078">    MeasurementPruningDefinitionPutResource resource = client</span>
        .wrap(MeasurementPruningDefinitionPutResource.class);
    try {
<span class="fc" id="L2081">      resource.store(gcd);</span>
    }
    finally {
<span class="fc" id="L2084">      client.release();</span>
<span class="fc" id="L2085">    }</span>
<span class="fc" id="L2086">  }</span>

  /*
   * (non-Javadoc)
   *
   * @see
   * org.wattdepot.client.WattDepotInterface#putMeasurementType(org.wattdepot
   * .datamodel.MeasurementType)
   */
  @Override
  public void putMeasurementType(MeasurementType type) {
<span class="fc" id="L2097">    ClientResource client = makeClient(Labels.PUBLIC + &quot;/&quot; + Labels.MEASUREMENT_TYPE + &quot;/&quot;);</span>
<span class="fc" id="L2098">    MeasurementTypePutResource resource = client.wrap(MeasurementTypePutResource.class);</span>
    try {
<span class="fc" id="L2100">      resource.store(type);</span>
    }
    finally {
<span class="fc" id="L2103">      client.release();</span>
<span class="fc" id="L2104">    }</span>
<span class="fc" id="L2105">  }</span>

  /*
   * (non-Javadoc)
   *
   * @see org.wattdepot.client.WattDepotInterface#putMeasurements(org.wattdepot.
   * datamodel.Depository, org.wattdepot.datamodel.MeasurementList)
   */
  @Override
  public void putMeasurements(Depository depository, MeasurementList measurementList)
      throws MeasurementTypeException, MeasurementListSizeExceededException {
<span class="fc" id="L2116">    List&lt;Measurement&gt; measurements = measurementList.getMeasurements();</span>

<span class="pc bpc" id="L2118" title="1 of 2 branches missed.">    if ( measurements.size() &lt;= 10000) {</span>
      //Running through all the measurements to insure that they fit
      //with measurementType of the depository.
<span class="fc bfc" id="L2121" title="All 2 branches covered.">      for (Measurement measurement : measurements) {</span>
<span class="pc bpc" id="L2122" title="1 of 2 branches missed.">        if (!depository.getMeasurementType().getUnits().equals(measurement.getMeasurementType())) {</span>
<span class="nc" id="L2123">          throw new MeasurementTypeException(&quot;Depository &quot; + depository.getName() + &quot; stores &quot;</span>
                  + depository.getMeasurementType() + &quot; not &quot; + measurement.getMeasurementType());
        }
<span class="fc" id="L2126">      }</span>
<span class="fc" id="L2127">      ClientResource client = makeClient(this.organizationId + &quot;/&quot; + Labels.DEPOSITORY + &quot;/&quot;</span>
              + depository.getId() + &quot;/&quot; + Labels.MEASUREMENTS + &quot;/&quot; + Labels.BULK + &quot;/&quot;);
<span class="fc" id="L2129">      DepositoryMeasurementsPutResource resource = client.wrap(DepositoryMeasurementsPutResource.class);</span>
      try {
<span class="fc" id="L2131">        resource.store(measurementList);</span>
      }
      finally {
<span class="fc" id="L2134">        client.release();</span>
<span class="fc" id="L2135">      }</span>
<span class="fc" id="L2136">    }</span>
    else {
<span class="nc" id="L2138">      throw new MeasurementListSizeExceededException(&quot;MeasurementList size of: &quot; + measurements.size() + &quot; exceeds size &quot;</span>
          + &quot;limit of 10.000&quot;);
    }
<span class="fc" id="L2141">  }</span>

  /*
   * (non-Javadoc)
   * 
   * @see
   * org.wattdepot.client.WattDepotInterface#putSensor(org.wattdepot.datamodel
   * .Sensor)
   */
  @Override
  public void putSensor(Sensor sensor) {
<span class="fc" id="L2152">    ClientResource client = makeClient(this.organizationId + &quot;/&quot; + Labels.SENSOR + &quot;/&quot;);</span>
<span class="fc" id="L2153">    SensorPutResource resource = client.wrap(SensorPutResource.class);</span>
    try {
<span class="fc" id="L2155">      resource.store(sensor);</span>
    }
    finally {
<span class="pc" id="L2158">      client.release();</span>
<span class="fc" id="L2159">    }</span>
<span class="fc" id="L2160">  }</span>

  /*
   * (non-Javadoc)
   * 
   * @see org.wattdepot.client.WattDepotInterface#putSensorGroup(org.wattdepot.
   * datamodel.SensorGroup)
   */
  @Override
  public void putSensorGroup(SensorGroup group) {
<span class="fc" id="L2170">    ClientResource client = makeClient(this.organizationId + &quot;/&quot; + Labels.SENSOR_GROUP + &quot;/&quot;);</span>
<span class="fc" id="L2171">    SensorGroupPutResource resource = client.wrap(SensorGroupPutResource.class);</span>
    try {
<span class="fc" id="L2173">      resource.store(group);</span>
    }
    finally {
<span class="fc" id="L2176">      client.release();</span>
<span class="fc" id="L2177">    }</span>
<span class="fc" id="L2178">  }</span>

  /*
   * (non-Javadoc)
   * 
   * @see org.wattdepot.client.WattDepotInterface#putSensorModel(org.wattdepot.
   * datamodel.SensorModel)
   */
  @Override
  public void putSensorModel(SensorModel model) {
<span class="fc" id="L2188">    ClientResource client = makeClient(Labels.PUBLIC + &quot;/&quot; + Labels.SENSOR_MODEL + &quot;/&quot;);</span>
<span class="fc" id="L2189">    SensorModelPutResource resource = client.wrap(SensorModelPutResource.class);</span>
    try {
<span class="fc" id="L2191">      resource.store(model);</span>
    }
    finally {
<span class="pc" id="L2194">      client.release();</span>
<span class="fc" id="L2195">    }</span>
<span class="fc" id="L2196">  }</span>

  /*
   * (non-Javadoc)
   * 
   * @see
   * org.wattdepot.client.WattDepotInterface#updateCollectorProcessDefinition
   * (org.wattdepot .datamodel.CollectorProcessDefinition)
   */
  @Override
  public void updateCollectorProcessDefinition(CollectorProcessDefinition process) {
<span class="fc" id="L2207">    ClientResource client = makeClient(this.organizationId + &quot;/&quot;</span>
        + Labels.COLLECTOR_PROCESS_DEFINITION + &quot;/&quot; + process.getId());
<span class="fc" id="L2209">    CollectorProcessDefinitionResource resource = client</span>
        .wrap(CollectorProcessDefinitionResource.class);
    try {
<span class="fc" id="L2212">      resource.update(process);</span>
    }
    finally {
<span class="fc" id="L2215">      client.release();</span>
<span class="fc" id="L2216">    }</span>
<span class="fc" id="L2217">  }</span>

  /*
   * (non-Javadoc)
   * 
   * @see org.wattdepot.client.WattDepotInterface#updateDepository(org.wattdepot
   * .datamodel.Depository)
   */
  @Override
  public void updateDepository(Depository depository) {
<span class="fc" id="L2227">    throw new RuntimeException(&quot;Can't update an existing Depository.&quot;);</span>
  }

  /*
   * (non-Javadoc)
   * 
   * @see
   * org.wattdepot.client.WattDepotInterface#updateMeasurementPruningDefinition
   * (org.wattdepot.common.domainmodel.MeasurementPruningDefinition)
   */
  @Override
  public void updateMeasurementPruningDefinition(MeasurementPruningDefinition gcd) {
<span class="fc" id="L2239">    ClientResource client = makeClient(this.organizationId + &quot;/&quot;</span>
        + Labels.MEASUREMENT_PRUNING_DEFINITION + &quot;/&quot; + gcd.getId());
<span class="fc" id="L2241">    MeasurementPruningDefinitionResource resource = client</span>
        .wrap(MeasurementPruningDefinitionResource.class);
    try {
<span class="fc" id="L2244">      resource.update(gcd);</span>
    }
    finally {
<span class="fc" id="L2247">      client.release();</span>
<span class="fc" id="L2248">    }</span>
<span class="fc" id="L2249">  }</span>

  /*
   * (non-Javadoc)
   * 
   * @see
   * org.wattdepot.client.WattDepotInterface#updateMeasurementType(org.wattdepot
   * .datamodel.MeasurementType)
   */
  @Override
  public void updateMeasurementType(MeasurementType type) {
<span class="fc" id="L2260">    ClientResource client = makeClient(Labels.PUBLIC + &quot;/&quot; + Labels.MEASUREMENT_TYPE + &quot;/&quot;</span>
        + type.getId());
<span class="fc" id="L2262">    MeasurementTypeResource resource = client.wrap(MeasurementTypeResource.class);</span>
    try {
<span class="fc" id="L2264">      resource.update(type);</span>
    }
    finally {
<span class="fc" id="L2267">      client.release();</span>
<span class="fc" id="L2268">    }</span>
<span class="fc" id="L2269">  }</span>

  /*
   * (non-Javadoc)
   * 
   * @see
   * org.wattdepot.client.WattDepotInterface#updateSensor(org.wattdepot.datamodel
   * .Sensor)
   */
  @Override
  public void updateSensor(Sensor sensor) {
<span class="fc" id="L2280">    ClientResource client = makeClient(this.organizationId + &quot;/&quot; + Labels.SENSOR + &quot;/&quot;</span>
        + sensor.getId());
<span class="fc" id="L2282">    SensorResource resource = client.wrap(SensorResource.class);</span>
    try {
<span class="fc" id="L2284">      resource.update(sensor);</span>
    }
    finally {
<span class="pc" id="L2287">      client.release();</span>
<span class="fc" id="L2288">    }</span>
<span class="fc" id="L2289">  }</span>

  /*
   * (non-Javadoc)
   * 
   * @see
   * org.wattdepot.client.WattDepotInterface#updateSensorGroup(org.wattdepot
   * .datamodel.SensorGroup)
   */
  @Override
  public void updateSensorGroup(SensorGroup group) {
<span class="fc" id="L2300">    ClientResource client = makeClient(this.organizationId + &quot;/&quot; + Labels.SENSOR_GROUP + &quot;/&quot;</span>
        + group.getId());
<span class="fc" id="L2302">    SensorGroupResource resource = client.wrap(SensorGroupResource.class);</span>
    try {
<span class="fc" id="L2304">      resource.update(group);</span>
    }
    finally {
<span class="pc" id="L2307">      client.release();</span>
<span class="fc" id="L2308">    }</span>
<span class="fc" id="L2309">  }</span>

  /*
   * (non-Javadoc)
   * 
   * @see
   * org.wattdepot.client.WattDepotInterface#updateSensorModel(org.wattdepot
   * .datamodel.SensorModel)
   */
  @Override
  public void updateSensorModel(SensorModel model) {
<span class="fc" id="L2320">    ClientResource client = makeClient(Labels.PUBLIC + &quot;/&quot; + Labels.SENSOR_MODEL + &quot;/&quot;</span>
        + model.getId());
<span class="fc" id="L2322">    SensorModelResource resource = client.wrap(SensorModelResource.class);</span>
    try {
<span class="fc" id="L2324">      resource.update(model);</span>
    }
    finally {
<span class="pc" id="L2327">      client.release();</span>
<span class="fc" id="L2328">    }</span>
<span class="fc" id="L2329">  }</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.2.201409121644</span></div></body></html>